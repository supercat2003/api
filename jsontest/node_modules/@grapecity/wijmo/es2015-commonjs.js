/*!
    *
    * Wijmo Library 5.20222.877
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.hasOwnProperty.call(e,s)&&(t[s]=e[s]);t.default=e;return t};Object.defineProperty(exports,"__esModule",{value:!0});const selfModule=__importStar(require("@grapecity/wijmo")),_agent="undefined"!=typeof navigator?navigator.userAgent:"",_isMobile=null!=_agent.match(/iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone/i);function isMobile(){return _isMobile}exports.isMobile=isMobile;const _isiOS=null!=_agent.match(/iPad|iPhone|iPod/i);function isiOS(){return _isiOS}exports.isiOS=isiOS;const _isFF=null!=_agent.match(/Firefox\//);function isFirefox(){return _isFF}exports.isFirefox=isFirefox;const _isSafari=null!=_agent.match(/^((?!Chrome|Android).)*safari/i);function isSafari(){return _isSafari}exports.isSafari=isSafari;const _isEdge=null!=_agent.match(/Edge\//);function isEdge(){return _isEdge}exports.isEdge=isEdge;const _isIE=null!=_agent.match(/MSIE |Trident\/|Edge\//);function isIE(){return _isIE}exports.isIE=isIE;let _isIE9=!1;function isIE9(){return _isIE9}exports.isIE9=isIE9;let _isIE10=!1;function isIE10(){return _isIE10}exports.isIE10=isIE10;let _supportsPassive=!1;"undefined"!=typeof document&&document.addEventListener("test",e=>{},{get passive(){_supportsPassive=!0;return!0}});function getEventOptions(e,t){return _supportsPassive?{capture:e,passive:t}:e}exports.getEventOptions=getEventOptions;var _supportsFocusOptions=!1;"undefined"!=typeof document&&document.createElement("div").focus({get preventScroll(){_supportsFocusOptions=!0;return!0}});function supportsFocusOptions(){return _supportsFocusOptions}exports.supportsFocusOptions=supportsFocusOptions;function _startDrag(e,t){e.effectAllowed=t;isFirefox()&&e.setData("text","")}exports._startDrag=_startDrag;if("undefined"!=typeof document&&document.doctype){navigator.appVersion.indexOf("MSIE 10")>-1&&(_isIE10=!0);if(navigator.appVersion.indexOf("MSIE 9")>-1){_isIE9=!0;document.addEventListener("mousemove",e=>{if(1==e.which){let t=closest(e.target,".wj-control");if(t&&!t.style.cursor)for(let t=e.target;t;t=t.parentElement)if(t.attributes&&t.attributes.draggable){t.dragDrop();return!1}}})}}if("undefined"!=typeof window){let e="requestAnimationFrame",t="cancelAnimationFrame";if(!window[e]){let s=0;window[e]=e=>{let t=Date.now(),i=16-(t-s),n=i>0?i:0;s=t+n;return setTimeout(()=>{e(s)},n)};window[t]=clearTimeout}if(!window.atob){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=new RegExp("[^"+e+"]");window.atob=s=>{let i,n,r,o,l=[],a=0,h=s.length;if(t.test(s)||/=/.test(s)&&(/=[^=]/.test(s)||/={3}/.test(s)))throw new Error("Invalid base64 data");h%4>0&&(h=(s+=Array(4-h%4+1).join("=")).length);for(;a<h;){for(n=[],o=a;a<o+4;)n.push(e.indexOf(s.charAt(a++)));r=[((i=(n[0]<<18)+(n[1]<<12)+((63&n[2])<<6)+(63&n[3]))&255<<16)>>16,64===n[2]?-1:(65280&i)>>8,64===n[3]?-1:255&i];for(o=0;o<3;++o)(r[o]>=0||0===o)&&l.push(String.fromCharCode(r[o]))}return l.join("")};window.btoa=t=>{let s,i,n=[],r=0,o=t.length;for(;r<o;){s=((i=[t.charCodeAt(r++),t.charCodeAt(r++),t.charCodeAt(r++)])[0]<<16)+((i[1]||0)<<8)+(i[2]||0);n.push(e.charAt((s&63<<18)>>18),e.charAt((258048&s)>>12),e.charAt(isNaN(i[1])?64:(4032&s)>>6),e.charAt(isNaN(i[2])?64:63&s))}return n.join("")}}}const _getProxyTarget="undefined"!=typeof window&&window.Symbol?Symbol("_getProxyTarget"):"\t_get\tProxy\tTarget\t";function _getCalculatedArray(e,t,s){let i=new WeakMap;if(!s){let t={};if(e.length){let i=e[0];for(let e in i){let s=typeof i[e];t[e]="string"==s?"":"number"==s?0:null}s=t}}return new Proxy(e,{get(e,n){if(n===_getProxyTarget)return e;if("string"==typeof n||"number"==typeof n){if("indexOf"==n)return(t,s)=>{let i=e.indexOf(t,s);i<0&&t&&(t=t[_getProxyTarget])&&(i=e.indexOf(t,s));return i};let r=parseInt(n);if(!isNaN(r)){let n=e[r];if(n&&!n[_getProxyTarget]){let e=i.get(n);if(!e){e=_createItemProxy(n,t,s);i.set(n,e)}n=e}return n}}return Reflect.get(e,n)}})}exports._getCalculatedArray=_getCalculatedArray;function _createItemProxy(e,t,s){if(!e[_getProxyTarget]){if(isIE())for(let s in t)e[s]=null;let i={get:(e,i,n)=>{if(i===_getProxyTarget)return e;if("constructor"===i)return()=>Object.assign({},s||{});let r=t[i];if(r)switch(typeof r){case"function":return r(n);case"string":return _eval(r,n)}return e[i]}};if(!isIE()){i.ownKeys=e=>Object.keys(e).concat(Object.keys(t));i.getOwnPropertyDescriptor=(e,s)=>s in t?{enumerable:!0,configurable:!0,writable:!1}:Reflect.getOwnPropertyDescriptor(e,s)}e=new Proxy(e,i)}return e}function _getTargetObject(e){return(e?e[_getProxyTarget]:null)||e}exports._getTargetObject=_getTargetObject;function _eval(e,t){let s=[t];return new Function(...["$"],"return "+e)(...s)}class _FocusService{constructor(){this._hasDoc="undefined"!=typeof Document;this._ae=this._nativeAe();let e=window,t=this._onBlur.bind(this),s=this._onFocus.bind(this);e.addEventListener("focusout",t,!0);e.addEventListener("focusin",s,!0);if(!isIE()){e.addEventListener("blur",t,!0);e.addEventListener("focus",s,!0)}}get activeElement(){let e=this._ae,t=this._nativeAe();e===_FocusService._noAe?e=this._ae=t:e!=t&&(this._isSpecialRoot(e)||document.body.contains(e)||(e=this._ae=t));return e!==_FocusService._noAe?e:null}_onBlur(e){if(e.isTrusted){let t=e.relatedTarget;this._ae=this._isSpecialRoot(t)?this._nativeAe():t}}_onFocus(e){e.isTrusted&&(this._ae=this._nativeAe())}_isSpecialRoot(e){return null==e||e===document.body||this._hasDoc&&e instanceof Document}_nativeAe(){let e;try{e="unknown"!=typeof document.activeElement?document.activeElement:_FocusService._noAe}catch(t){e=_FocusService._noAe}return e}}_FocusService._noAe={};"undefined"!=typeof window&&(exports._focusSrv=new _FocusService);class Binding{constructor(e){this.path=e}get path(){return this._path}set path(e){this._path=e;this._parts=e?e.split("."):[];for(let e=0;e<this._parts.length;e++){let t=this._parts[e],s=t.indexOf("[");if(s>-1){this._parts[e]=t.substr(0,s);this._parts.splice(++e,0,parseInt(t.substr(s+1)))}}this._key=1==this._parts.length?this._parts[0]:null}getValue(e){if(e){if(this._key)return e[this._key];if(this._path&&this._path in e)return e[this._path];for(let t=0;t<this._parts.length&&e;t++)e=e[this._parts[t]]}return e}setValue(e,t){if(e)try{let s=this._path;if(s in e){e[s]=t;return e[s]==t}for(let t=0;t<this._parts.length-1;t++)if(null==(e=e[this._parts[t]]))return!1;e[s=this._parts[this._parts.length-1]]=t;return e[s]==t}catch(e){return!1}return!1}}exports.Binding=Binding;class EventHandler{constructor(e,t){this.handler=e;this.self=t}}class Event{constructor(e){this._handlers=[];this._handlersChanged=e}addHandler(e,t){e=asFunction(e);this._handlers.push(new EventHandler(e,t));isFunction(this._handlersChanged)&&this._handlersChanged()}removeHandler(e,t){let s=!1;e=asFunction(e);for(let i=0;i<this._handlers.length;i++){let n=this._handlers[i];if(!(n.handler!=e&&null!=e||n.self!=t&&null!=t)){this._handlers.splice(i--,1);s=!0;if(e&&t)break}}s&&isFunction(this._handlersChanged)&&this._handlersChanged()}removeAllHandlers(){let e=this._handlers.length>0;this._handlers.length=0;e&&isFunction(this._handlersChanged)&&this._handlersChanged()}raise(e,t=EventArgs.empty){let s=this._handlers;for(let i=0;i<s.length;i++){let n=s[i];n.handler.call(n.self,e,t);s[i]!==n&&i--}}get hasHandlers(){return this._handlers.length>0}get handlerCount(){return this._handlers.length}}exports.Event=Event;class EventArgs{}EventArgs.empty=new EventArgs;exports.EventArgs=EventArgs;class CancelEventArgs extends EventArgs{constructor(){super(...arguments);this.cancel=!1}}exports.CancelEventArgs=CancelEventArgs;class PropertyChangedEventArgs extends EventArgs{constructor(e,t,s){super();this._name=e;this._oldVal=t;this._newVal=s}get propertyName(){return this._name}get oldValue(){return this._oldVal}get newValue(){return this._newVal}}exports.PropertyChangedEventArgs=PropertyChangedEventArgs;class RequestErrorEventArgs extends CancelEventArgs{constructor(e,t){super();this._xhr=e;this._msg=t}get request(){return this._xhr}get message(){return this._msg}set message(e){this._msg=e}}exports.RequestErrorEventArgs=RequestErrorEventArgs;var NotifyCollectionChangedAction;!function(e){e[e.Add=0]="Add";e[e.Remove=1]="Remove";e[e.Change=2]="Change";e[e.Reset=3]="Reset"}(NotifyCollectionChangedAction=exports.NotifyCollectionChangedAction||(exports.NotifyCollectionChangedAction={}));class NotifyCollectionChangedEventArgs extends EventArgs{constructor(e=NotifyCollectionChangedAction.Reset,t=null,s=-1){super();this.action=e;this.item=t;this.index=s}}NotifyCollectionChangedEventArgs.reset=new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset);exports.NotifyCollectionChangedEventArgs=NotifyCollectionChangedEventArgs;class SortDescription{constructor(e,t){this._bnd=new Binding(e);this._asc=t}get property(){return this._bnd.path}get ascending(){return this._asc}}exports.SortDescription=SortDescription;class PageChangingEventArgs extends CancelEventArgs{constructor(e){super();this.newPageIndex=e}}exports.PageChangingEventArgs=PageChangingEventArgs;class GroupDescription{groupNameFromItem(e,t){return""}namesMatch(e,t){return e===t}}exports.GroupDescription=GroupDescription;class PropertyGroupDescription extends GroupDescription{constructor(e,t){super();this._bnd=new Binding(e);this._converter=t}get propertyName(){return this._bnd.path}groupNameFromItem(e,t){return this._converter?this._converter(e,this.propertyName):this._bnd.getValue(e)}namesMatch(e,t){return e===t}}exports.PropertyGroupDescription=PropertyGroupDescription;var Key,DataType,_VERSION="5.20222.877";function getVersion(){return _VERSION}exports.getVersion=getVersion;function setLicenseKey(e){Control._licKey=e}exports.setLicenseKey=setLicenseKey;!function(e){e[e.Back=8]="Back";e[e.Tab=9]="Tab";e[e.Enter=13]="Enter";e[e.Escape=27]="Escape";e[e.Space=32]="Space";e[e.PageUp=33]="PageUp";e[e.PageDown=34]="PageDown";e[e.End=35]="End";e[e.Home=36]="Home";e[e.Left=37]="Left";e[e.Up=38]="Up";e[e.Right=39]="Right";e[e.Down=40]="Down";e[e.Delete=46]="Delete";e[e.F1=112]="F1";e[e.F2=113]="F2";e[e.F3=114]="F3";e[e.F4=115]="F4";e[e.F5=116]="F5";e[e.F6=117]="F6";e[e.F7=118]="F7";e[e.F8=119]="F8";e[e.F9=120]="F9";e[e.F10=121]="F10";e[e.F11=122]="F11";e[e.F12=123]="F12"}(Key=exports.Key||(exports.Key={}));!function(e){e[e.Object=0]="Object";e[e.String=1]="String";e[e.Number=2]="Number";e[e.Boolean=3]="Boolean";e[e.Date=4]="Date";e[e.Array=5]="Array"}(DataType=exports.DataType||(exports.DataType={}));function tryCast(e,t){return null==e?null:isString(t)?isFunction(e.implementsInterface)&&e.implementsInterface(t)?e:null:e instanceof t?e:null}exports.tryCast=tryCast;function isPrimitive(e){return isString(e)||isNumber(e)||isBoolean(e)||isDate(e)}exports.isPrimitive=isPrimitive;function isString(e){return"string"==typeof e}exports.isString=isString;function isNullOrWhiteSpace(e){return!e||!/\S/.test(e)}exports.isNullOrWhiteSpace=isNullOrWhiteSpace;function isNumber(e){return"number"==typeof e}exports.isNumber=isNumber;function isInt(e){return isNumber(e)&&e==Math.round(e)}exports.isInt=isInt;function isBoolean(e){return"boolean"==typeof e}exports.isBoolean=isBoolean;function isFunction(e){return"function"==typeof e}exports.isFunction=isFunction;function isUndefined(e){return void 0===e}exports.isUndefined=isUndefined;function isDate(e){return(e instanceof Date||"[object Date]"===Object.prototype.toString.call(e))&&!isNaN(e.getTime())}exports.isDate=isDate;function isArray(e){return e instanceof Array||Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)}exports.isArray=isArray;function isObject(e){return null!=e&&"object"==typeof e&&!isDate(e)&&!isArray(e)}exports.isObject=isObject;function isEmpty(e){for(var t in e)return!1;return!0}exports.isEmpty=isEmpty;function getUniqueId(e){let t=e;for(let s=0;null!=document.getElementById(t);s++)t=e+s;return t}exports.getUniqueId=getUniqueId;function mouseToPage(e){if(e instanceof Point)return e;e&&e.touches&&e.touches.length>0&&(e=e.touches[0]);if(isNumber(e.clientX)&&isNumber(e.clientY))return new Point(e.clientX+pageXOffset,e.clientY+pageYOffset);throw"Mouse or touch event expected."}exports.mouseToPage=mouseToPage;function getType(e){return isNumber(e)?DataType.Number:isBoolean(e)?DataType.Boolean:isDate(e)?DataType.Date:isString(e)?DataType.String:isArray(e)?DataType.Array:DataType.Object}exports.getType=getType;function getTypes(e,t=1e3){if(!e)return[];const s=e.length;(t<=0||s<t)&&(t=s);const i=[];if(t){const s=Object.keys(e[0]),n={},r=[...s];for(let s=0;s<t;s++){const t=e[s];for(let i=r.length-1;i>=0;i--){const o=r[i],l=t[o];if(isPrimitive(l)){let t=Object.getOwnPropertyDescriptor(e[s],o);n[o]={binding:o,dataType:getType(l),isReadOnly:t&&!t.writable&&!t.set};r.splice(i,1)}}if(!r.length)break}for(let e=0;e<s.length;e++){const t=n[s[e]];t&&i.push(t)}}return i}exports.getTypes=getTypes;function changeType(e,t,s,i){if(null!=e){let n=DataType;if(isString(e))switch(t){case n.Number:let t=Globalize.parseFloat(e,s);return isNaN(t)?e:t;case n.Date:let r=Globalize.parseDate(e,s,isDate(i)?i:null);r||s||!e||(r=new Date(e));return r&&isFinite(r.getTime())?r:e;case n.Boolean:switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return e;case n.Array:try{let t=e.split(",").map(e=>(e=e.trim()).match(/^(\+|\-)?\d+\.?\d*$/)?e:'"'+e+'"');return JSON.parse("["+t.join(",")+"]")}catch(e){}}if(t==DataType.String)return Globalize.format(e,s)}return e}exports.changeType=changeType;function toFixed(e,t,s){if(s){let s=e.toString(),i=s.indexOf("e"),n=s.indexOf(".");if(i>-1){if("-"===s[i+1]){let r=parseFloat(s.substr(i+2)),o=s.substr(0,i);n>-1&&(o=o.substr(0,n)+o.substr(n+1));s="0."+(Array(r).join("0")+o).substr(0,t);e=parseFloat(s)}}else if(n>-1){s=s.substr(0,n+1+t);e=parseFloat(s)}}else{let s=Math.pow(10,t);e=Math.round(e*s)/s}return e}exports.toFixed=toFixed;function format(e,t,s){if((e=asString(e)).match(/\{.*"count".*:.*"when".*:.*\}/))try{let s=JSON.parse(e);if(isString(s.count)){let i=t[s.count],n=s.when;if(isNumber(i)&&isObject(n)){let t=n[i]||n.other;isString(t)&&(e=t)}}}catch(e){}return e.replace(/\{(.*?)(:(.*?))?\}/g,(e,i,n,r)=>{let o=e;if(i&&"{"!=i[0]&&t){o=new Binding(i).getValue(t);r&&(o=Globalize.format(o,r));s&&(o=s(t,i,r,o))}return null==o?"":o})}exports.format=format;function glbz(...e){let t=[],s=-1;e[0].forEach((i,n)=>{if(n>0&&n!=s){let r=e[n],o=i.match(/^:([a-z][0-9]*\b)/i)||i.match(/^:'(.+?)'/)||i.match(/^:"(.+?)"/);if(o){r=Globalize.format(r,o[1]);i=i.substr(o[0].length)}else if(":"==i&&n<e.length-1&&(isNumber(r)||isDate(r))){r=Globalize.format(r,e[n+1]);i="";s=n+1}t.push(r)}i&&t.push(i)});return t.join("")}exports.glbz=glbz;function evalTemplate(e,t){if(isIE()){let s=/:\${([^}]*)}/g,i=/\${([^}]*)}(:(([A-Za-z]\d*)|"([^"]+)"|'([^']+)'))?/g;return(e=e.replace(s,(e,s)=>":"+_evalExpression(s,t))).replace(i,(e,s,i,n,r,o,l)=>{let a=_evalExpression(s,t);return n?Globalize.format(a,r||o||l):a})}return _evalExpression(e,t)}exports.evalTemplate=evalTemplate;function _evalExpression(e,t){(t=t||{}).glbz=glbz;let s=Object.keys(t),i=s.map(e=>t[e]);return(isIE()?new Function(...s,"return "+e):new Function(...s,"return glbz`"+e+"`"))(...i)}function clamp(e,t,s){if(null!=e){null!=s&&e>s&&(e=s);null!=t&&e<t&&(e=t)}return e}exports.clamp=clamp;function copy(e,t){if(t)for(let s in t)if("_"!=s[0]){assert(s in e,'Unknown property "'+s+'".');let i=t[s];e._copy&&e._copy(s,i)||(e[s]instanceof Event?isFunction(i)&&e[s].addHandler(i):!isObject(i)||"undefined"!=typeof Element&&i instanceof Element||!e[s]||"itemsSource"==s?e[s]=i:copy(e[s],i))}return e}exports.copy=copy;function assert(e,t){if(!e){t="** Assertion failed in Wijmo: "+t;let e=new Error;isString(e.stack)&&(t+=" "+e.stack);throw t}}exports.assert=assert;function _deprecated(e,t){console.error('** WARNING: "'+e+'" has been deprecated; please use "'+t+'" instead.')}exports._deprecated=_deprecated;function asString(e,t=!0){isUndefined(e)&&(e=null);assert(t&&null==e||isString(e),"String expected.");return e}exports.asString=asString;function asNumber(e,t=!1,s=!1){assert(t&&null==e||isNumber(e),"Number expected.");if(s&&e&&e<0)throw"Positive number expected.";return e}exports.asNumber=asNumber;function asInt(e,t=!1,s=!1){assert(t&&null==e||isInt(e),"Integer expected.");if(s&&e&&e<0)throw"Positive integer expected.";return e}exports.asInt=asInt;function asBoolean(e,t=!1){assert(t&&null==e||isBoolean(e),"Boolean expected.");return e}exports.asBoolean=asBoolean;function asDate(e,t=!1){if(isString(e)){let t=changeType(e,DataType.Date,"r");isDate(t)&&(e=t)}assert(t&&null==e||isDate(e),"Date expected.");return e}exports.asDate=asDate;function asFunction(e,t=!0){assert(t&&null==e||isFunction(e),"Function expected.");return e}exports.asFunction=asFunction;function asArray(e,t=!0){assert(t&&null==e||isArray(e),"Array expected.");return e}exports.asArray=asArray;function asType(e,t,s=!1){e=tryCast(e,t);assert(s||null!=e,t+" expected.");return e}exports.asType=asType;function asEnum(e,t,s=!1){if(null==e&&s)return null;let i=isString(e)?t[e]:e;assert(null!=i,'Invalid enum value: "'+e+'"');return isNumber(i)?i:e}exports.asEnum=asEnum;function asCollectionView(e,t=!0){if(null==e&&t)return null;let s=tryCast(e,"ICollectionView");if(null!=s)return s;isArray(e)||assert(!1,"Array or ICollectionView expected.");return new CollectionView(e)}exports.asCollectionView=asCollectionView;function hasItems(e){return null!=e&&null!=e.items&&e.items.length>0}exports.hasItems=hasItems;function toHeaderCase(e){return e&&e.length?e[0].toUpperCase()+e.substr(1).replace(/([a-z])([A-Z])/g,"$1 $2"):""}exports.toHeaderCase=toHeaderCase;function escapeHtml(e){e&&isString(e)&&(e=e.replace(/[&<>"'\/]/g,e=>_ENTITYMAP[e]));return null!=e?e.toString():""}exports.escapeHtml=escapeHtml;const _ENTITYMAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeRegExp(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}exports.escapeRegExp=escapeRegExp;function toPlainText(e){let t=asString(e);if(isString(t)&&t.indexOf("<")>-1){_plainText||(_plainText=document.createElement("div"));_plainText.innerHTML=t;t=_plainText.textContent}return t}exports.toPlainText=toPlainText;var _plainText;function hasClass(e,t){if(e&&t){if(e instanceof HTMLElement&&e.classList&&!isIE9())return e.classList.contains(t);if(e.getAttribute){let s=new RegExp("(\\s|^)"+t+"(\\s|$)");return e&&s.test(e.getAttribute("class"))}}return!1}exports.hasClass=hasClass;function addClass(e,t){if(e&&t){if(e instanceof HTMLElement&&e.classList&&!isIE9()){t.indexOf(" ")<0?e.classList.add(t):t.split(" ").forEach(t=>{e.classList.add(t)});return}e.setAttribute&&t.split(" ").forEach(t=>{if(!hasClass(e,t)){let s=e.getAttribute("class");e.setAttribute("class",s?s+" "+t:t)}})}}exports.addClass=addClass;function removeClass(e,t){if(e&&t){if(e instanceof HTMLElement&&e.classList&&!isIE9()){t.indexOf(" ")<0?e.classList.remove(t):t.split(" ").forEach(t=>{e.classList.remove(t)});return}e.setAttribute&&t.split(" ").forEach(t=>{if(hasClass(e,t)){let s=new RegExp("((\\s|^)"+t+"(\\s|$))","g"),i=e.getAttribute("class");(i=i.replace(s," ").replace(/ +/g," ").trim())?e.setAttribute("class",i):e.removeAttribute("class")}})}}exports.removeClass=removeClass;function toggleClass(e,t,s){null==s&&(s=!hasClass(e,t));s?addClass(e,t):removeClass(e,t)}exports.toggleClass=toggleClass;function setAttribute(e,t,s,i){e&&(null!=s?i&&e.getAttribute(t)||e.setAttribute(t,s.toString()):e.removeAttribute(t))}exports.setAttribute=setAttribute;function setChecked(e,t){let s=null==t;e.checked=isIE()?t||s:t;e.indeterminate=s}exports.setChecked=setChecked;function setAriaLabel(e,t){setAttribute(e,"aria-label",t)}exports.setAriaLabel=setAriaLabel;function setSelectionRange(e,t,s=t,i=!0){assert(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement,"INPUT or TEXTAREA element expected");if(contains(document.body,e)&&!e.disabled&&e.offsetHeight){try{e.setSelectionRange(t,s,"backward")}catch(e){}if(i)try{e.focus();return!0}catch(e){}}return!1}exports.setSelectionRange=setSelectionRange;function disableAutoComplete(e){let t="autocomplete",s=e.getAttribute(t);s&&"on"!=s||e.setAttribute(t,"off");"autocorrect,autocapitalize,spellcheck".split(",").forEach(t=>{e.setAttribute(t,"spellcheck"==t?"false":"off")})}exports.disableAutoComplete=disableAutoComplete;function removeChild(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}exports.removeChild=removeChild;function getActiveElement(){let e=document.activeElement;if(e){let t=e.shadowRoot;t&&t.activeElement&&(e=t.activeElement)}return e}exports.getActiveElement=getActiveElement;function _getActiveElement(){let e=exports._focusSrv.activeElement;if(e){let t=e.shadowRoot;t&&t.activeElement&&(e=t.activeElement)}return e}exports._getActiveElement=_getActiveElement;function moveFocus(e,t){let s=_getFocusableElements(e,t<0),i=0;if(t){let e=s.indexOf(getActiveElement());e>-1&&(i=(e+t+s.length)%s.length)}if(i<s.length){let e=s[i];e.focus();e instanceof HTMLInputElement&&e.select();return!0}return!1}exports.moveFocus=moveFocus;function _getFocusableElements(e,t=!1){let s=[],i=Array.prototype.slice.call(e.querySelectorAll("input,select,textarea,button,a,div")),n={};const isRb=e=>e instanceof HTMLInputElement&&"radio"===e.type;i.forEach(e=>{isRb(e)&&e.checked&&(n[e.name||""]=!0)});(i=i.filter(e=>!isRb(e)||e.checked||!n[e.name||""])).sort((e,t)=>e.tabIndex-t.tabIndex);for(let e=0;e<i.length;e++){let n=i[e];if(n.offsetHeight>0&&n.tabIndex>-1&&!n.disabled&&"hidden"!==window.getComputedStyle(n).visibility&&!closest(n,"[disabled],.wj-state-disabled")){if(n instanceof HTMLAnchorElement&&!n.hasAttribute("href"))continue;if(isIE()&&!n.hasAttribute("tabindex")){if(n instanceof HTMLDivElement)continue;let e=Control.getControl(closest(n,".wj-flexgrid"));if(e&&0==e.keyActionTab)continue}if("radio"===n.type&&!n.checked&&s.length>0){let e=s[s.length-1];if("radio"===e.type&&e.name===n.name){t&&(s[s.length-1]=n);continue}}!Control.getControl(n)&&_getFocusableElements(n).length||s.push(n)}}return s}function saveFile(e,t,s="text/plain"){let i=e instanceof Blob;i||!s.match(/\bcsv\b/i)&&!t.match(/\.csv$/i)||(e="\ufeff"+e);let n=i?e:new Blob([e],{type:s});if(isFunction(navigator.msSaveOrOpenBlob))navigator.msSaveOrOpenBlob(n,t);else{var r=document.createElement("a"),click=e=>{let t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);e.dispatchEvent(t)};if("download"in r){let e=window.URL||window.webkitURL,s=e.createObjectURL(n);r.href=s;r.target="_blank";r.download=t;click(r);r=null;window.setTimeout(()=>{e.revokeObjectURL(s)},3e4)}else{let e=new FileReader;e.onloadend=()=>{r.href=e.result;r.download=t;click(r);r=null};e.readAsDataURL(n)}}}exports.saveFile=saveFile;function getElement(e){if(e instanceof Element)return e;if(isString(e))try{return document.querySelector(e)}catch(e){}return e&&e.jquery?e[0]:null}exports.getElement=getElement;function createElement(e,t,s){e=e.replace(/\bstyle\s*=\s*"/g,'_wj-style="');let i=document.createElement("div");i.innerHTML=e;if(e.indexOf("_wj-style")>-1){let e=i.querySelectorAll("[_wj-style]");for(let t=0;t<e.length;t++){let s=e[t];s.getAttribute("_wj-style").split(";").forEach(e=>{let t=e.split(":");2==t.length&&(s.style[t[0].trim()]=t[1].trim())});s.removeAttribute("_wj-style")}}1==i.children.length&&(i=i.children[0]);s&&setCss(i,s);t&&(t=getElement(t)).appendChild(i);return i}exports.createElement=createElement;function setText(e,t){e.textContent=t||""}exports.setText=setText;function contains(e,t,s){for(let i=t;i&&e;){if(i===e)return!0;i=(s?i[Control._OWNR_KEY]:null)||i.parentNode||i.host}return!1}exports.contains=contains;function closest(e,t){if(e){if(isFunction(e.closest))return e.closest(t);let s=e.matches||e.webkitMatchesSelector||e.msMatchesSelector||e.mozMatchesSelector;if(s)for(;e&&1===e.nodeType;e=e.parentElement||e.parentNode)if(s.call(e,t))return e}return null}exports.closest=closest;function closestClass(e,t){return closest(e,"."+t)}exports.closestClass=closestClass;function enable(e,t){let s=!t,i="disabled";toggleClass(e,"wj-state-disabled",s);setAttribute(e,i,s?i:null);let n=e.querySelectorAll("input,button");for(let e=0;e<n.length;e++)setAttribute(n[e],i,s?i:null)}exports.enable=enable;function getElementRect(e){let t=e.getBoundingClientRect();return new Rect(t.left+pageXOffset,t.top+pageYOffset,t.width,t.height)}exports.getElementRect=getElementRect;function setCss(e,t){assert(isObject(t),"css parameter should be an object");if(e instanceof Array)for(let s=0;s<e.length;s++)setCss(e[s],t);else if(e&&e.style){let s=e.style;for(let e in t){let i=t[e];"number"==typeof i&&e.match(/width|height|left|top|right|bottom|size|padding|margin'/i)&&(i+="px");s[e]!==i&&(s[e]=i)}}}exports.setCss=setCss;function animate(e,t,s){null==t&&(t=Control._ANIM_DEF_DURATION);null==s&&(s=Control._ANIM_DEF_STEP);e=asFunction(e);t=asNumber(t,!1,!0);s=asNumber(s,!1,!0);let i,n=Date.now(),r=setInterval(()=>{let s=Math.min(1,(Date.now()-n)/t);s=Math.sin(s*Math.PI/2);s*=s;i&&cancelAnimationFrame(i);i=requestAnimationFrame(()=>{i=null;e(s)});s>=1&&clearInterval(r)},s);return r}exports.animate=animate;class Point{constructor(e=0,t=0){this.x=asNumber(e);this.y=asNumber(t)}equals(e){return e instanceof Point&&this.x==e.x&&this.y==e.y}clone(){return new Point(this.x,this.y)}}exports.Point=Point;class Size{constructor(e=0,t=0){this.width=asNumber(e);this.height=asNumber(t)}equals(e){return e instanceof Size&&this.width==e.width&&this.height==e.height}clone(){return new Size(this.width,this.height)}}exports.Size=Size;class Rect{constructor(e,t,s,i){this.left=asNumber(e);this.top=asNumber(t);this.width=asNumber(s);this.height=asNumber(i)}get right(){return this.left+this.width}get bottom(){return this.top+this.height}equals(e){return e instanceof Rect&&this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height}clone(){return new Rect(this.left,this.top,this.width,this.height)}static fromBoundingRect(e){if(null!=e.left)return new Rect(e.left,e.top,e.width,e.height);if(null!=e.x)return new Rect(e.x,e.y,e.width,e.height);assert(!1,"Invalid source rectangle.")}static union(e,t){let s=Math.min(e.left,t.left),i=Math.min(e.top,t.top),n=Math.max(e.right,t.right),r=Math.max(e.bottom,t.bottom);return new Rect(s,i,n-s,r-i)}static intersection(e,t){let s=Math.max(e.left,t.left),i=Math.max(e.top,t.top),n=Math.min(e.right,t.right),r=Math.min(e.bottom,t.bottom);return new Rect(s,i,n-s,r-i)}contains(e){if(e instanceof Point)return e.x>=this.left&&e.x<=this.right&&e.y>=this.top&&e.y<=this.bottom;if(e instanceof Rect){let t=e;return t.left>=this.left&&t.right<=this.right&&t.top>=this.top&&t.bottom<=this.bottom}assert(!1,"Point or Rect expected.")}inflate(e,t){return new Rect(this.left-e,this.top-t,this.width+2*e,this.height+2*t)}}exports.Rect=Rect;class DateTime{static addDays(e,t){(e=new Date(e.getTime())).setDate(e.getDate()+t);return e}static addMonths(e,t){var s=(e=new Date(e.getTime())).getDate();e.setMonth(e.getMonth()+t);e.getDate()!=s&&e.setDate(0);return e}static addYears(e,t){(e=new Date(e.getTime())).setFullYear(e.getFullYear()+t);return e}static addHours(e,t){(e=new Date(e.getTime())).setHours(e.getHours()+t);return e}static addMinutes(e,t){(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t);return e}static addSeconds(e,t){(e=new Date(e.getTime())).setSeconds(e.getSeconds()+t);return e}static weekFirst(e,t=Globalize.getFirstDayOfWeek()){return DateTime.addDays(e,-(e.getDay()-t))}static weekLast(e,t=Globalize.getFirstDayOfWeek()){e=DateTime.weekFirst(e,t);return DateTime.addDays(e,6)}static monthFirst(e){return DateTime.addDays(e,1-e.getDate())}static monthLast(e){e=DateTime.monthFirst(e);e=DateTime.addMonths(e,1);return DateTime.addDays(e,-1)}static yearFirst(e){return new Date(e.getFullYear(),0,1)}static yearLast(e){return new Date(e.getFullYear(),11,31)}static sameDate(e,t){return isDate(e)&&isDate(t)&&e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}static sameTime(e,t){return isDate(e)&&isDate(t)&&e.getHours()==t.getHours()&&e.getMinutes()==t.getMinutes()&&e.getSeconds()==t.getSeconds()&&e.getMilliseconds()==t.getMilliseconds()}static equals(e,t){return null==e&&null==t||isDate(e)&&isDate(t)&&e.getTime()==t.getTime()}static fromDateTime(e,t){if(!e&&!t)return null;e||(e=t);t||(t=e);return DateTime.newDate(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}static toFiscal(e,t){let s=exports.culture.Globalize.calendar;return isArray(s.fiscalYearOffsets)?DateTime.addMonths(e,-s.fiscalYearOffsets[t?0:1]):e}static fromFiscal(e,t){let s=exports.culture.Globalize.calendar;return isArray(s.fiscalYearOffsets)?DateTime.addMonths(e,+s.fiscalYearOffsets[t?0:1]):e}static newDate(e,t,s,i,n,r,o){if(null==e||null==t||null==s){let i=new Date;null==e&&(e=i.getFullYear());null==t&&(t=i.getMonth());null==s&&(s=i.getDate())}null==i&&(i=0);null==n&&(n=0);null==r&&(r=0);null==o&&(o=0);let l=new Date(e,t,s,i,n,r,o),a=l.getFullYear();e<100&&a>=1900&&l.setFullYear(l.getFullYear()-1900);return l}static clone(e){return DateTime.fromDateTime(e,e)}}exports.DateTime=DateTime;function httpRequest(e,t){let s=t||{},i=s.method?asString(s.method).toUpperCase():"GET",n=null==s.async||asBoolean(s.async),r=s.data;if(null!=r&&"GET"==i){let t=[];for(let e in r){let s=r[e];isDate(s)&&(s=s.toJSON());t.push(e+"="+encodeURIComponent(s))}if(t.length){let s=e.indexOf("?")<0?"?":"&";e+=s+t.join("&")}r=null}let o=new XMLHttpRequest;o.URL_DEBUG=e;let l=!1;if(null!=r&&!isString(r)){l=isObject(r);r=JSON.stringify(r)}o.onload=function(){if(4==o.readyState){o.status<300?s.success&&asFunction(s.success)(o):s.error&&asFunction(s.error)(o);s.complete&&asFunction(s.complete)(o)}};o.onerror=function(){if(!isFunction(s.error))throw"HttpRequest Error: "+o.status+" "+o.statusText;s.error(o)};o.open(i,e,n,s.user,s.password);s.user&&s.password&&o.setRequestHeader("Authorization","Basic "+btoa(s.user+":"+s.password));l&&(()=>{for(let e in s.requestHeaders)if("content-type"===e.toLowerCase())return!1;return!0})()&&o.setRequestHeader("Content-Type","application/json");if(s.requestHeaders)for(let e in s.requestHeaders)o.setRequestHeader(e,s.requestHeaders[e]);isNumber(s.timeout)&&(o.timeout=s.timeout);isFunction(s.beforeSend)&&s.beforeSend(o);o.send(r);return o}exports.httpRequest=httpRequest;let _modules={};function _registerModule(e,t){_modules[e]=t;if("wijmo"===e){let e="undefined"!=typeof window?window:"undefined"!=typeof self?self:null;e&&(e.wijmo=t)}}exports._registerModule=_registerModule;function _getModule(e){return _modules[e]}exports._getModule=_getModule;class _Map{constructor(e=!0){if(e)this._h={};else{let e=_getGlobal(),t=e&&e.Map;this._m=t&&new Map||new _ArrayMap}}get isPojoHash(){return null!=this._h}get size(){return this._h&&Object.keys(this._h).length||this._m.size}clear(){this._h?this._h={}:this._m.clear()}delete(e){this._h?delete this._h[e]:this._m.delete(e)}get(e){return this._h?this._h[e]:this._m.get(e)}has(e){return this._h?e in this._h:this._m.has(e)}set(e,t){this._h?this._h[e]=t:this._m.set(e,t);return this}}exports._Map=_Map;class _ArrayMap{constructor(){this._d=[]}get size(){return this._d.length}clear(){this._d=[]}delete(e){let t=this._kIdx(e);if(t>-1){this._d.splice(t,1);return!0}return!1}get(e){let t=this._kIdx(e);return t>-1?this._d[t].v:void 0}has(e){return this._kIdx(e)>-1}set(e,t){let s=this._kIdx(e);s>-1?this._d[s].v=t:this._d.push({k:e,v:t});return this}_kIdx(e){let t=this._d,s=t.length;if(e==e){for(let i=0;i<s;i++)if(t[i].k===e)return i}else for(let e=0;e<s;e++){let s=t[e].k;if(s!=s)return e}return-1}}function _getGlobal(){let e=null;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self);return e}class Color{constructor(e){this._r=0;this._g=0;this._b=0;this._a=1;e&&this._parse(e)}get r(){return this._r}set r(e){this._r=clamp(asNumber(e),0,255)}get g(){return this._g}set g(e){this._g=clamp(asNumber(e),0,255)}get b(){return this._b}set b(e){this._b=clamp(asNumber(e),0,255)}get a(){return this._a}set a(e){this._a=clamp(asNumber(e),0,1)}equals(e){return e instanceof Color&&this.r==e.r&&this.g==e.g&&this.b==e.b&&this.a==e.a}toString(){let e=Math.round(100*this.a);return e>99?"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1):"rgba("+this.r+","+this.g+","+this.b+","+e/100+")"}static fromRgba(e,t,s,i=1){let n=new Color(null);n.r=Math.round(clamp(asNumber(e),0,255));n.g=Math.round(clamp(asNumber(t),0,255));n.b=Math.round(clamp(asNumber(s),0,255));n.a=clamp(asNumber(i),0,1);return n}static fromHsb(e,t,s,i=1){let n=Color._hsbToRgb(clamp(asNumber(e),0,1),clamp(asNumber(t),0,1),clamp(asNumber(s),0,1));return Color.fromRgba(n[0],n[1],n[2],i)}static fromHsl(e,t,s,i=1){let n=Color._hslToRgb(clamp(asNumber(e),0,1),clamp(asNumber(t),0,1),clamp(asNumber(s),0,1));return Color.fromRgba(n[0],n[1],n[2],i)}static fromString(e){let t=new Color(null);return t._parse(asString(e))?t:null}getHsb(){return Color._rgbToHsb(this.r,this.g,this.b)}getHsl(){return Color._rgbToHsl(this.r,this.g,this.b)}static interpolate(e,t,s){s=clamp(asNumber(s),0,1);let i=Color._rgbToHsl(e.r,e.g,e.b),n=Color._rgbToHsl(t.r,t.g,t.b),r=1-s,o=e.a*r+t.a*s,l=[i[0]*r+n[0]*s,i[1]*r+n[1]*s,i[2]*r+n[2]*s],a=Color._hslToRgb(l[0],l[1],l[2]);return Color.fromRgba(a[0],a[1],a[2],o)}static toOpaque(e,t){if(1==(e=isString(e)?Color.fromString(e):asType(e,Color)).a)return e;t=null==t?Color.fromRgba(255,255,255,1):isString(t)?Color.fromString(t):asType(t,Color);let s=e.a,i=1-s;return Color.fromRgba(e.r*s+t.r*i,e.g*s+t.g*i,e.b*s+t.b*i)}_parse(e){if("transparent"==(e=e.toLowerCase())){this._r=this._g=this._b=this._a=0;return!0}if(e&&0!=e.indexOf("#")&&0!=e.indexOf("rgb")&&0!=e.indexOf("hsl")){let t=document.createElement("div");t.style.color=e;let s=t.style.color;if(s==e&&!(s=window.getComputedStyle(t).color)){document.body.appendChild(t);s=window.getComputedStyle(t).color;removeChild(t)}e=s.toLowerCase()}if(0==e.indexOf("#")){if(4==e.length){this.r=parseInt(e[1]+e[1],16);this.g=parseInt(e[2]+e[2],16);this.b=parseInt(e[3]+e[3],16);this.a=1;return!0}if(7==e.length){this.r=parseInt(e.substr(1,2),16);this.g=parseInt(e.substr(3,2),16);this.b=parseInt(e.substr(5,2),16);this.a=1;return!0}return!1}if(0==e.indexOf("rgb")){let t=e.indexOf("("),s=e.indexOf(")");if(t>-1&&s>-1){let i=e.substr(t+1,s-(t+1)).split(",");if(i.length>2){this.r=parseInt(i[0]);this.g=parseInt(i[1]);this.b=parseInt(i[2]);this.a=i.length>3?parseFloat(i[3]):1;return!0}}}if(0==e.indexOf("hsl")){let t=e.indexOf("("),s=e.indexOf(")");if(t>-1&&s>-1){let i=e.substr(t+1,s-(t+1)).split(",");if(i.length>2){let e=parseInt(i[0])/360,t=parseInt(i[1]),s=parseInt(i[2]);i[1].indexOf("%")>-1&&(t/=100);i[2].indexOf("%")>-1&&(s/=100);let n=Color._hslToRgb(e,t,s);this.r=n[0];this.g=n[1];this.b=n[2];this.a=i.length>3?parseFloat(i[3]):1;return!0}}}return!1}static _hslToRgb(e,t,s){assert(e>=0&&e<=1&&t>=0&&t<=1&&s>=0&&s<=1,"bad HSL values");let i,n,r;if(0==t)i=n=r=s;else{let o=s<.5?s*(1+t):s+t-s*t,l=2*s-o;i=Color._hue2rgb(l,o,e+1/3);n=Color._hue2rgb(l,o,e);r=Color._hue2rgb(l,o,e-1/3)}return[Math.round(255*i),Math.round(255*n),Math.round(255*r)]}static _hue2rgb(e,t,s){s<0&&(s+=1);s>1&&(s-=1);return s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e}static _rgbToHsl(e,t,s){assert(e>=0&&e<=255&&t>=0&&t<=255&&s>=0&&s<=255,"bad RGB values");e/=255,t/=255,s/=255;let i,n,r=Math.max(e,t,s),o=Math.min(e,t,s),l=(r+o)/2;if(r==o)i=n=0;else{let a=r-o;n=l>.5?a/(2-r-o):a/(r+o);switch(r){case e:i=(t-s)/a+(t<s?6:0);break;case t:i=(s-e)/a+2;break;case s:i=(e-t)/a+4}i/=6}return[i,n,l]}static _rgbToHsb(e,t,s){assert(e>=0&&e<=255&&t>=0&&t<=255&&s>=0&&s<=255,"bad RGB values");let i=Color._rgbToHsl(e,t,s);return Color._hslToHsb(i[0],i[1],i[2])}static _hsbToRgb(e,t,s){let i=Color._hsbToHsl(e,t,s);return Color._hslToRgb(i[0],i[1],i[2])}static _hsbToHsl(e,t,s){assert(e>=0&&e<=1&&t>=0&&t<=1&&s>=0&&s<=1,"bad HSB values");let i=clamp(s*(2-t)/2,0,1),n=1-Math.abs(2*i-1),r=clamp(n>0?s*t/n:t,0,1);assert(!isNaN(i)&&!isNaN(r),"bad conversion to HSL");return[e,r,i]}static _hslToHsb(e,t,s){assert(e>=0&&e<=1&&t>=0&&t<=1&&s>=0&&s<=1,"bad HSL values");let i=clamp(1==s?1:(2*s+t*(1-Math.abs(2*s-1)))/2,0,1),n=clamp(i>0?2*(i-s)/i:t,0,1);assert(!isNaN(i)&&!isNaN(n),"bad conversion to HSB");return[e,n,i]}}exports.Color=Color;exports.culture="undefined"!=typeof window&&window.wijmo&&window.wijmo.culture||{Globalize:{numberFormat:{".":".",",":",","-":"-","+":"+","%":"%",percent:{pattern:["-n%","n%"]},currency:{decimals:2,symbol:"$",pattern:["($n)","$n"]}},calendar:{"/":"/",":":":",firstDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],am:["AM","A"],pm:["PM","P"],eras:["A.D.","B.C."],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",t:"h:mm tt",T:"h:mm:ss tt",M:"MMMM d",m:"MMMM d",Y:"MMMM, yyyy",y:"MMMM, yyyy",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",s:'yyyy"-"MM"-"dd"T"HH":"mm":"ss',o:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',O:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',U:"dddd, MMMM dd, yyyy h:mm:ss tt"},fiscalYearOffsets:[-3,-3]}}};class Globalize{static format(e,t,s,i,n){if(isString(e))return e;if(isNumber(e)){t=t||(e==Math.round(e)?"n0":"n2");return Globalize.formatNumber(e,t,s,i,n)}if(isDate(e)){t=t||"d";return Globalize.formatDate(e,t)}return null!=e?e.toString():""}static formatNumber(e,t,s,i,n){e=asNumber(e);t=asString(t);let r,o=exports.culture.Globalize.numberFormat,l=Globalize._parseNumericFormat(t),a=l.spec,h=l.prec,c=o["."]||".",u=o[","]||",",d=o["-"]||"-",p=Math;null==h&&(h=null!=n?n:"c"==a?o.currency.decimals:"e"==a?6:"r"==a?15:e==p.round(e)?0:2);l.scale&&(e/=p.pow(10,l.scale));if("d"==a||"x"==a){r=(i?p.floor:p.round)(p.abs(e)).toString("d"==a?10:16);for(;r.length<h;)r="0"+r;e<0&&(r=d+r);return"X"==l.specRaw?r.toUpperCase():r}i&&"p"!=a&&"e"!=a&&(e=toFixed(e,h,!0));switch(a){case"e":r=e.toExponential(h);"E"==l.specRaw&&(r=r.replace("e","E"));break;case"c":r=Globalize._toFixedStr(p.abs(e),h);break;case"p":e=Globalize._shiftDecimal(e,2,14);i&&(e=toFixed(e,h,i));r=Globalize._toFixedStr(p.abs(e),h);break;default:"-"!=(r=Globalize._toFixedStr(e,h))[0]||r.match(/[1-9]/)||(r=r.substr(1))}(s||"g"==a||"r"==a)&&r.indexOf(".")>-1&&(r=r.replace(/(\.\d*?)0+$/g,"$1").replace(/\.$/,""));"."!=c&&(r=r.replace(".",c));"-"!=d&&(r=r.replace("-",d));if(u&&("n"==a||"c"==a||"p"==l.specRaw||"F"==l.specRaw||"G"==l.specRaw)){let e=r.indexOf(c),t=/\B(?=(\d\d\d)+(?!\d))/g;r=e>-1?r.substr(0,e).replace(t,u)+r.substr(e):r.replace(t,u)}if("c"==a){let t=e<0&&r.match(/[1-9]/)?0:1,s=o.currency.pattern[t],i=l.curr||o.currency.symbol;"​"==i&&(i="");r=s.replace("n",r).replace("$",i)}if("p"==a){let t=e<0&&r.match(/[1-9]/)?0:1,s=o.percent.pattern[t],i=o["%"]||"%";r=s.replace("n",r);"%"!=i&&(r=r.replace("%",i));"-"!=d&&0==t&&(r=r.replace("-",d))}return l.prefix||l.suffix?l.prefix+r+l.suffix:r}static formatDate(e,t){e=asDate(e);switch(t){case"r":case"R":return e.toUTCString();case"u":return e.toISOString().replace(/\.\d{3}/,"")}t=Globalize._expandFormat(t);return Globalize._parseDateFormat(t).map(s=>Globalize._formatDatePart(e,t,s)).join("")}static parseInt(e,t){return Math.round(Globalize.parseFloat(e,t))}static parseFloat(e,t){let s=Globalize._parseNumericFormat(t),i=s.prefix;i&&0==e.indexOf(i)&&(e=e.substring(i.length));let n=s.suffix;if(n){let t=e.lastIndexOf(n);t>-1&&t==e.length-n.length&&(e=e.substring(0,e.length-n.length))}let r=exports.culture.Globalize.numberFormat,o=r["."]||".",l=r[","]||",",a=r["-"]||"-",h=r["%"]||"%",c=s.curr||r.currency.symbol||"$",u=e.indexOf(h)>-1,d=e.indexOf("(")>-1&&e.indexOf(")")>-1,p=0;if("x"==s.spec)p=parseInt(e,16);else{[c,h,"(",")"].forEach(t=>{e=e.replace(t,"")});/\s/.test(l)&&(e=e.replace(/\s+/g,""));let t=(e=e.replace(new RegExp("\\"+l,"g"),"").replace(new RegExp("\\"+a,"g"),"-").replace(/(\+|\-)\s+/g,"$1").replace(o,".").trim()).length;if(!d&&t&&"-"==e[t-1]){d=!0;e=e.substring(0,t-1)}p=/^\s*(\+|\-)?\d*(\.\d*)?(\s*E(\+|\-)?\d+)?\s*$/i.test(e)?parseFloat(e):Number.NaN}if(!isNaN(p)){d=d||p<0;p=Math.abs(p);u&&(p=Globalize._shiftDecimal(p,-2));d&&(p=-p);s.scale&&(p*=Math.pow(10,s.scale))}return p}static parseDate(e,t,s){if(!(e=asString(e)))return null;if("u"==t)return new Date(e);let i;if("R"==t||"r"==t){let t=/((\d+)\-(\d+)\-(\d+))?\s?((\d+):(\d+)(:(\d+))?)?/,s=e.match(t);if(s[1]||s[5]){i=s[1]?new Date(parseInt(s[2]),parseInt(s[3])-1,parseInt(s[4])):new Date;if(s[5]){i.setHours(parseInt(s[6]));i.setMinutes(parseInt(s[7]));i.setSeconds(s[8]?parseInt(s[9]):0)}}else i=new Date(e);return isNaN(i.getTime())?null:i}t=Globalize._expandFormat(t||"d");let n=exports.culture.Globalize.calendar,r=Globalize._CJK,o=new RegExp("(\\"+n["/"]+")|(\\"+n[":"]+")|(\\d+)|(["+r+"\\.]{2,})|(["+r+"]+)","gi"),l=e.match(o),a=Globalize._parseDateFormat(t),h=0;if(!(l&&l.length&&a&&a.length))return null;let c,u,d,p,g,f=-1,_=0,m=1,C=0,b=0,y=0,w=0,v=-1,x=null;if(s=asDate(s,!0)){_=s.getMonth();m=s.getDate();C=s.getHours();b=s.getMinutes();y=s.getSeconds();w=s.getMilliseconds()}for(let e=0;e<a.length&&l;e++){let t=e-h,s=t>-1&&t<l.length?l[t]:"",i=a[e].length;switch(a[e]){case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":g=a[e];case"yyyy":case"yyy":case"yy":case"y":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}f=parseInt(s);p=4==s.length;break;case"MMMM":case"MMM":d=!0;_=-1;let r=s.toLowerCase(),o="MMMM"==a[e]?n.months:n.monthsAbbr;for(let e=0;e<12;e++)if(0==o[e].toLowerCase().indexOf(r)){_=e;break}if(_>-1)break;case"MM":case"M":d=!0;if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}_=parseInt(s)-1;break;case"dddd":case"ddd":c=!0;break;case"dd":case"d":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}m=parseInt(s);u=!0;break;case"hh":case"h":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}C=12==(C=parseInt(s))?0:C;break;case"HH":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}C=parseInt(s);break;case"H":C=parseInt(s);break;case"mm":case"m":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}b=parseInt(s);break;case"ss":case"s":if(i>1&&s.length>i){l[t]=s.substr(i);s=s.substr(0,i);h++}y=parseInt(s);break;case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":w=parseInt(s)/Math.pow(10,i-3);break;case"tt":case"t":s=s.toUpperCase();C<12&&n.pm.indexOf(s)>-1&&(C+=12);break;case"q":case"Q":case"u":case"U":v=parseInt(s);break;case"ggg":case"gg":case"g":x=n.eras.length>1?Globalize._getEra(s,n):null;if(n.eras.length>0&&!x)return null;break;case"/":case":":if(s&&s!=n[a[e]])return null;break;case n["/"]:case n[":"]:if(s&&s!=a[e])return null;break;case"K":break;default:Globalize._unquote(a[e]).trim()!=s.trim()&&h++}}if(d&&u){isNaN(C)&&(C=0);isNaN(b)&&(b=0);isNaN(y)&&(y=0)}if(_<0||_>11||isNaN(_)||m<1||m>31||isNaN(m)||C<0||C>=24||isNaN(C)||b<0||b>=60||isNaN(b)||y<0||y>=60||isNaN(y))return null;if(l.length+h>a.length)return null;if(g){if(!d)return null;let e=exports.culture.Globalize.calendar;if(isArray(e.fiscalYearOffsets)){let t="E"==g[0],s=_-e.fiscalYearOffsets[t?0:1];f+=s>11?-1:s<0?1:0}}if(c&&!u)return null;!d&&v>=1&&v<=4&&(_=3*(v-1));if(isNaN(f)||f<0)f=s?s.getFullYear():(new Date).getFullYear();else if(x&&x.start)f=f+x.start.getFullYear()-1;else if(f<100&&!p){let e=isNumber(n.twoDigitYearMax)?n.twoDigitYearMax:2029;e>99&&(f+=f+2e3<=e?2e3:1900)}return(i=DateTime.newDate(f,_,m,C,b+0,y,w)).getMonth()!=_||i.getDate()!=m?null:isNaN(i.getTime())?null:i}static getFirstDayOfWeek(){let e=exports.culture.Globalize.calendar.firstDay;return e||0}static getNumberDecimalSeparator(){let e=exports.culture.Globalize.numberFormat["."];return e||"."}static _toFixedStr(e,t){let s=e.toString(),i=s.indexOf("."),n=t-(s.length-i)+1,r=s.indexOf("e")>-1;if(!r&&i>-1&&n>=0)return s+Array(n+1).join("0");if(i>-1&&!r&&"5"==s[s.length-1]){e=+(Math.round(+(Math.abs(e)+"e"+t))+"e"+-t)*(e<0?-1:1)}return e.toFixed(t)}static _unquote(e){return e.length>1&&e[0]==e[e.length-1]&&("'"==e[0]||'"'==e[0])?e.substr(1,e.length-2):e}static _parseNumericFormat(e){let t=Globalize._numFormatInfo[e];if(!t){let s=e&&e.match(/(\"(.*?)\"\s*)?([a-z]+)\s*(\d*)\s*(,*)(\s*\"(.*?)\"\s*)?(.*)/i)||[],i=s[3]?s[3]:"n";if(i.length>1){s=[];i="n"}t={prefix:s[2]||"",spec:i.toLowerCase(),specRaw:i,prec:s[4]?parseInt(s[4]):null,scale:s[5]?3*s[5].length:0,suffix:s[7]||"",curr:s[8]||null};Globalize._numFormatInfo[e]=t}return t}static _parseDateFormat(e){let t=Globalize._dateFormatParts[e];if(!t){t=[];if(e){let s,i;for(s=0;s>-1&&s<e.length;s++){let n=e[s];if(("'"==n||'"'==n)&&(i=e.indexOf(n,s+1))>-1){t.push(e.substring(s,i+1));s=i}else if("\\"==n&&s<e.length-1){s++;t.push('"'+e[s]+'"')}else{i=s+1;for(;i<e.length&&e[i]==n;i++);t.push(e.substring(s,i));s=i-1}}}Globalize._dateFormatParts[e]=t}return t}static _formatDatePart(e,t,s){let i,n=exports.culture.Globalize.calendar,r=null,o=0,l=0,a=s.length;switch(s){case"yyyy":case"yyy":case"yy":case"y":case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":o=(i="E"==s[0]?DateTime.toFiscal(e,!0):"e"==s[0]?DateTime.toFiscal(e,!1):e).getFullYear();n.eras.length>1&&t.indexOf("g")>-1&&(r=Globalize._getEra(e,n))&&(o=isDate(r.start)?o-r.start.getFullYear()+1:Math.abs(o));let h=s.length<3?o%100:3==s.length?o%1e3:o;return Globalize._zeroPad(h,s.length);case"MMMMM":return n.monthsAbbr[e.getMonth()][0];case"MMMM":return n.months[e.getMonth()];case"MMM":return n.monthsAbbr[e.getMonth()];case"MM":case"M":return Globalize._zeroPad(e.getMonth()+1,a);case"dddd":return n.days[e.getDay()];case"ddd":return n.daysAbbr[e.getDay()];case"dd":return Globalize._zeroPad(e.getDate(),2);case"d":return e.getDate().toString();case"hh":case"h":return Globalize._zeroPad(Globalize._h12(e),a);case"HH":case"H":return Globalize._zeroPad(e.getHours(),a);case"mm":case"m":return Globalize._zeroPad(e.getMinutes(),a);case"ss":case"s":return Globalize._zeroPad(e.getSeconds(),a);case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":l=e.getMilliseconds()*Math.pow(10,a-3);return"f"==s[0]?Globalize._zeroPad(l,a):l.toFixed(0);case"tt":return e.getHours()<12?n.am[0]:n.pm[0];case"t":return e.getHours()<12?n.am[1]:n.pm[1];case"q":case"Q":return(Math.floor(e.getMonth()/3)+1).toString();case"u":case"U":i=DateTime.toFiscal(e,"U"==s);return(Math.floor(i.getMonth()/3)+1).toString();case"ggg":case"gg":case"g":if(n.eras.length>1&&(r=Globalize._getEra(e,n))){if(isString(r))return r;switch(s){case"gg":return r.name[0];case"g":return r.symbol;default:return r.name}}return n.eras[0];case":":case"/":return n[s];case"K":let c=e.toString().match(/(\+|\-)(\d{2})(\d{2})/);return c?c[1]+c[2]+c[3]:"";case"zzz":case"zz":case"z":let u,d=-e.getTimezoneOffset(),p=Math.abs(d),g=Globalize.formatNumber;switch(s){case"zzz":u=g(p/60,"d2",!1,!0)+n[":"]+g(p%60,"d2",!1,!0);break;case"zz":u=g(p/60,"d2",!1,!0);break;case"z":u=g(p/60,"d1",!1,!0)}return(d>=0?"+":"-")+u}return a>1&&s[0]==s[a-1]&&('"'==s[0]||"'"==s[0])?s.substr(1,a-2):s}static _getEra(e,t){if(t.eras){let s=t.eras,i=t.eras.length;if(isDate(e)){if(isString(s[0]))return s[e.getFullYear()>=0?0:1];if(isDate(s[0].start)){for(let t=0;t<i;t++)if(e>=s[t].start)return s[t];return s[i-1]}}else if(isString(e)&&e.length>0){e=e.toLowerCase();for(let t=0;t<i;t++){let i=s[t];if(isString(i)){if(0==i.toLowerCase().indexOf(e))return i}else if(i.name&&0==i.name.toLowerCase().indexOf(e)||i.symbol&&0==i.symbol.toLowerCase().indexOf(e))return i}}}return null}static _expandFormat(e){let t=exports.culture.Globalize.calendar.patterns[e];return t||e}static _zeroPad(e,t){let s=e.toFixed(0),i=t-s.length+1;return i>0?Array(i).join("0")+s:s}static _h12(e){let t=exports.culture.Globalize.calendar,s=e.getHours();t.am&&t.am[0]&&0==(s%=12)&&(s=12);return s}static _shiftDecimal(e,t,s){if(0==t||isNaN(e))return e;let i=e.toString();if(i.indexOf("e")>-1){let i=e*Math.pow(10,t);null!=s&&(i=parseFloat(i.toFixed(s)));return i}let n=Array(Math.abs(t)+1).join("0");t<0&&(i=n+i);var r=i.indexOf(".");r<0&&(r=(i+=".").indexOf("."));t>0&&(i+=n);r+=t;i=(i=i.replace(".","")).substr(0,r)+"."+i.substr(r);return parseFloat(i)}}Globalize._CJK="a-z"+"u00c0-u017fu3000-u30ffu4e00-u9faf".replace(/u/g,"\\u")+"u1100-u11ffu3130-u318fua960-ua97fuac00-ud7afud7b0-ud7ff".replace(/u/g,"\\u");Globalize._numFormatInfo={};Globalize._dateFormatParts={};exports.Globalize=Globalize;function _updateCulture(e){exports.culture=e}exports._updateCulture=_updateCulture;function _addCultureInfo(e,t){let s="undefined"!=typeof window?window.wijmo:null,i=s?s.culture:null,n=i?i[e]:null;exports.culture[e]=n||t}exports._addCultureInfo=_addCultureInfo;class _MaskProvider{constructor(e,t="",s="_"){this._promptChar="_";this._mskArr=[];this._overWrite=!1;this._full=!0;this._inputBnd=this._input.bind(this);this._keydownBnd=this._keydown.bind(this);this._keypressBnd=this._keypress.bind(this);this._cmpstartBnd=this._cmpstart.bind(this);this._cmpendBnd=this._cmpend.bind(this);this.mask=asString(t);this.input=e;this.promptChar=asString(s,!1);this._connect(!0);(this._evtInput=document.createEvent("HTMLEvents")).initEvent("input",!0,!1)}get input(){return this._tbx}set input(e){this._connect(!1);this._tbx=e;this._connect(!0)}get mask(){return this._msk}set mask(e){if(e!=this._msk){this._msk=asString(e,!0);this._parseMask();this._valueChanged()}}get promptChar(){return this._promptChar}set promptChar(e){if(e!=this._promptChar){assert(1==(e=asString(e,!1)).length,"promptChar must be a string with length 1.");let t=this._tbx,s=t.value,i="",n=this._mskArr,r=this._promptChar;for(let t=0;t<s.length;t++){let o=n[t],l=s[t];o&&o.literal||l!==r||(l=e);i+=l}t.value=i;this._promptChar=e}}get overwriteMode(){return this._overWrite}set overwriteMode(e){this._overWrite=asBoolean(e)}get maskFull(){return this._full}getMaskRange(){return this._mskArr.length?[this._firstPos,this._lastPos]:[0,this._tbx.value.length-1]}getRawValue(){let e=this._tbx?this._tbx.value:"";if(!this.mask)return e;let t="";for(let s=0;s<this._mskArr.length&&s<e.length;s++)this._mskArr[s].literal||e[s]==this._promptChar||(t+=e[s]);return t}refresh(){this._parseMask();this._valueChanged()}_input(e){if(this._msk&&!this._composing&&e!=this._evtInput){e.preventDefault();e.stopImmediatePropagation();setTimeout(()=>{this._valueChanged();this._tbx&&this._tbx.dispatchEvent(this._evtInput)})}}_keydown(e){if(e.keyCode==Key.Back){let t=this._tbx.selectionStart,s=this._tbx.selectionEnd;if(t<=this._firstPos&&s==t){e.preventDefault();this._backSpace=!1;return}}this._backSpace=e.keyCode==Key.Back}_keypress(e){e.ctrlKey||e.metaKey||e.altKey||this._composing||!this._preventKey(e.charCode)||e.preventDefault()}_cmpstart(e){this._composing=!0}_cmpend(e){if(this._composing){this._composing=!1;setTimeout(()=>{let e=this._tbx;e&&this._valueChanged()&&e.dispatchEvent(this._evtInput)})}}_preventKey(e){if(e&&this._mskArr.length){let t=this._tbx,s=t.selectionStart,i=String.fromCharCode(e);s<this._firstPos&&setSelectionRange(t,s=this._firstPos);if(s>=this._mskArr.length)return!0;let n=this._mskArr[s];if(n.literal)this._validatePosition(s);else if(n.wildCard!=i&&!this._isCharValid(n.wildCard,i))return!0}return!1}_connect(e){let t=this._tbx;if(t){assert(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement,"INPUT or TEXTAREA element expected.");if(e){this._autoComplete=t.autocomplete;this._spellCheck=t.spellcheck;t.autocomplete="off";t.spellcheck=!1;t.addEventListener("input",this._inputBnd,!0);t.addEventListener("keydown",this._keydownBnd,!0);t.addEventListener("keypress",this._keypressBnd,!0);t.addEventListener("compositionstart",this._cmpstartBnd,!0);t.addEventListener("compositionend",this._cmpendBnd,!0);t.addEventListener("blur",this._cmpendBnd,!0);this._valueChanged()}else{t.autocomplete=this._autoComplete;t.spellcheck=this._spellCheck;t.removeEventListener("input",this._inputBnd,!0);t.removeEventListener("keydown",this._keydownBnd,!0);t.removeEventListener("keypress",this._keypressBnd,!0);t.removeEventListener("compositionstart",this._cmpstartBnd,!0);t.removeEventListener("compositionend",this._cmpendBnd,!0);t.removeEventListener("blur",this._cmpendBnd,!0)}}}_valueChanged(){if(!this._tbx||!this._msk)return!1;let e=this._tbx,t=e.selectionStart,s=t>0?e.value[t-1]:"",i=e.value;e.value=this._applyMask();""==i&&(t=this._firstPos+1);let n=t>0?e.value[t-1]:"";t>0&&n==this._promptChar&&s!=this.promptChar&&t--;t==i.length&&(t=this._matchEnd);this._validatePosition(t);return i!=e.value}_applyMask(){let e=this._tbx,t=e.value;this._full=!0;this._matchEnd=0;if(!this._msk)return t;if(!t&&!e.required)return t;if(this._overWrite){let s=e.selectionStart;e==document.activeElement&&e.selectionEnd==s&&t.length>this.mask.length&&(t=t.substr(0,s)+t.substr(s+t.length-this.mask.length))}t=this._handleVagueLiterals(t);let s="",i=0,n=this._promptChar;for(let e=0;e<this._mskArr.length;e++){let r=this._mskArr[e],o=r.literal;o&&o==t[i]&&i++;if(r.wildCard){o=n;if(t){let e=i;for(;e<t.length;e++)if(this._isCharValid(r.wildCard,t[e])){o=t[e];switch(r.charCase){case">":o=o.toUpperCase();break;case"<":o=o.toLowerCase()}o!=n&&(this._matchEnd=s.length+1);break}i=e+1}o==n&&(this._full=!1)}s+=o}return s}_handleVagueLiterals(e){if(e.length>this._mskArr.length+1)return e;let t=e.length-this._mskArr.length;if(0!=t&&e.length>1){let s=-1,i=this._tbx,n=i==getActiveElement()?i.selectionStart:i.value.length;for(let e=Math.max(0,n-t);e<this._mskArr.length;e++)if(this._mskArr[e].vague){s=e;break}if(s>-1)if(t<0){let i=Array(1-t).join(this._promptChar),n=s+t;n>-1&&(e=e.substr(0,n)+i+e.substr(n))}else{for(;s>0&&this._mskArr[s-1].literal;)s--;e=e.substr(0,s)+e.substr(s+t)}}return e}_isCharValid(e,t){if(t==this._promptChar)return!0;switch(e){case"0":return this._isDigit(t);case"9":return this._isDigit(t)||" "==t;case"#":return this._isDigit(t)||" "==t||"+"==t||"-"==t;case"L":return this._isLetter(t);case"l":return this._isLetter(t)||" "==t;case"A":return this._isDigit(t)||this._isLetter(t);case"a":return this._isDigit(t)||this._isLetter(t)||" "==t;case"９":return t>="０"&&t<="９";case"Ｊ":case"Ｇ":return!("Ｇ"==e&&_MaskProvider._X_DBCS_BIG_HIRA.indexOf(t)>-1)&&(t>="ぁ"&&t<="ゟ");case"Ｋ":case"Ｎ":return!("Ｎ"==e&&_MaskProvider._X_DBCS_BIG_KATA.indexOf(t)>-1)&&(t>="゠"&&t<="ヿ");case"Ｚ":return!(t>="ｦ"&&t<="ﾟ")&&(t<="!"||t>="ÿ");case"H":return t>="!"&&t<="ÿ"||t>="ｦ"&&t<="ﾟ";case"K":case"N":return!("N"==e&&_MaskProvider._X_SBCS_BIG_KATA.indexOf(t)>-1)&&(t>="ｦ"&&t<="ﾟ")}return!1}_isDigit(e){return e>="0"&&e<="9"}_isLetter(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_validatePosition(e){let t=this._mskArr;if(this._backSpace)for(;e>0&&e<t.length&&t[e-1].literal;)e--;if(0==e||!this._backSpace)for(;e<t.length&&t[e].literal;)e++;getActiveElement()==this._tbx&&setSelectionRange(this._tbx,e);this._backSpace=!1}_parseMask(){this._mskArr=[];this._firstPos=-1;this._lastPos=-1;let e,t=this._msk,s="|";for(let i=0;t&&i<t.length;i++)switch(t[i]){case"0":case"9":case"#":case"A":case"a":case"L":case"l":case"９":case"Ｊ":case"Ｇ":case"Ｋ":case"Ｎ":case"Ｚ":case"K":case"N":case"H":this._firstPos<0&&(this._firstPos=this._mskArr.length);this._lastPos=this._mskArr.length;this._mskArr.push(new _MaskElement(t[i],s));break;case".":case",":case":":case"/":case"$":switch(t[i]){case".":case",":e=exports.culture.Globalize.numberFormat[t[i]];break;case":":case"/":e=exports.culture.Globalize.calendar[t[i]];break;case"$":e=exports.culture.Globalize.numberFormat.currency.symbol}for(let t=0;t<e.length;t++)this._mskArr.push(new _MaskElement(e[t]));break;case"<":case">":case"|":s=t[i];break;case"\\":i<t.length-1&&i++;this._mskArr.push(new _MaskElement(t[i]));break;default:this._mskArr.push(new _MaskElement(t[i]))}for(let e=0;e<this._mskArr.length;e++){let t=this._mskArr[e];if(t.literal)for(let s=0;s<e;s++){let e=this._mskArr[s];if(e.wildCard&&this._isCharValid(e.wildCard,t.literal)){t.vague=!0;break}}}}}_MaskProvider._X_DBCS_BIG_HIRA="ぁぃぅぇぉっゃゅょゎゕゖ";_MaskProvider._X_DBCS_BIG_KATA="ァィゥェォッャュョヮヵヶ";_MaskProvider._X_SBCS_BIG_KATA="ｧｨｩｪｫｬｭｮｯ";exports._MaskProvider=_MaskProvider;class _MaskElement{constructor(e,t){if(t){this.wildCard=e;this.charCase=t}else this.literal=e}}exports._MaskElement=_MaskElement;var Aggregate;!function(e){e[e.None=0]="None";e[e.Sum=1]="Sum";e[e.Cnt=2]="Cnt";e[e.Avg=3]="Avg";e[e.Max=4]="Max";e[e.Min=5]="Min";e[e.Rng=6]="Rng";e[e.Std=7]="Std";e[e.Var=8]="Var";e[e.StdPop=9]="StdPop";e[e.VarPop=10]="VarPop";e[e.CntAll=11]="CntAll";e[e.First=12]="First";e[e.Last=13]="Last"}(Aggregate=exports.Aggregate||(exports.Aggregate={}));function getAggregate(e,t,s){let i=0,n=0,r=0,o=0,l=null,a=null,h=null,c=s?new Binding(s):null;if((e=asEnum(e,Aggregate))==Aggregate.CntAll)return t.length;for(let s=0;s<t.length;s++){let u=t[s];c&&(u=c.getValue(u));if(null!=u){if(e==Aggregate.First)return u;i++;(null==l||u<l)&&(l=u);(null==a||u>a)&&(a=u);h=u;if(isNumber(u)&&!isNaN(u)){n++;r+=u;o+=u*u}else if(isBoolean(u)){n++;if(1==u){r++;o++}}}}let u=0==n?0:r/n;switch(e){case Aggregate.Avg:return u;case Aggregate.Cnt:return i;case Aggregate.Max:return a;case Aggregate.Min:return l;case Aggregate.Rng:return a-l;case Aggregate.Sum:return r;case Aggregate.VarPop:return n<=1?0:o/n-u*u;case Aggregate.StdPop:return n<=1?0:Math.sqrt(o/n-u*u);case Aggregate.Var:return n<=1?0:(o/n-u*u)*n/(n-1);case Aggregate.Std:return n<=1?0:Math.sqrt((o/n-u*u)*n/(n-1));case Aggregate.Last:return h}throw"Invalid aggregate type."}exports.getAggregate=getAggregate;class ArrayBase extends Array{constructor(){canChangePrototype?this.length=0:super()}}exports.ArrayBase=ArrayBase;var canChangePrototype=!0;try{ArrayBase.prototype=Array.prototype;canChangePrototype=ArrayBase.prototype===Array.prototype}catch(e){canChangePrototype=!1}var SortNulls,symb="undefined"!=typeof window?window.Symbol:null;!canChangePrototype&&symb&&symb.species&&Object.defineProperty(ArrayBase,symb.species,{get:function(){return Array},enumerable:!1,configurable:!1});class ObservableArray extends ArrayBase{constructor(e){super();this._updating=0;this.collectionChanged=new Event;if(e){e=asArray(e);this._updating++;for(let t=0;t<e.length;t++)this.push(e[t]);this._updating--}}push(...e){e.forEach(e=>{super.push(e);this._raiseCollectionChanged(NotifyCollectionChangedAction.Add,e,this.length-1)});return this.length}shift(){let e=super.shift();this._raiseCollectionChanged(NotifyCollectionChangedAction.Remove,e,0);return e}unshift(...e){let t=super.unshift(...e);1==e.length?this._raiseCollectionChanged(NotifyCollectionChangedAction.Add,e[0],0):this._raiseCollectionChanged();return t}pop(){let e=super.pop();this._raiseCollectionChanged(NotifyCollectionChangedAction.Remove,e,this.length);return e}splice(e,t,...s){let i,n=NotifyCollectionChangedAction,r=this._raiseCollectionChanged.bind(this);if(t&&s.length){i=super.splice(e,t,...s);1==t&&1==s.length?r(n.Change,s[0],e):r()}else if(s.length){i=super.splice(e,0,...s);1==s.length?r(n.Add,s[0],e):r()}else{i=super.splice(e,t);1==t?r(n.Remove,i[0],e):r()}return i}slice(e,t){return super.slice(e,t)}indexOf(e,t){return super.indexOf(e,t)}sort(e){let t=super.sort(e);this._raiseCollectionChanged();return t}insert(e,t){this.splice(e,0,t)}remove(e){let t=this.indexOf(e);t>-1&&this.removeAt(t);return t>-1}removeAt(e){this.splice(e,1)}setAt(e,t){e>=this.length&&(this.length=e+1);this.splice(e,1,t)}clear(){this.length&&this.splice(0,this.length)}beginUpdate(){this._updating++}endUpdate(){this._updating--;this._updating<=0&&this._raiseCollectionChanged()}get isUpdating(){return this._updating>0}deferUpdate(e){try{this.beginUpdate();e()}finally{this.endUpdate()}}implementsInterface(e){return"INotifyCollectionChanged"==e}onCollectionChanged(e=NotifyCollectionChangedEventArgs.reset){this.isUpdating||this.collectionChanged.raise(this,e)}_raiseCollectionChanged(e=NotifyCollectionChangedAction.Reset,t,s){if(!this.isUpdating){let i=new NotifyCollectionChangedEventArgs(e,t,s);this.onCollectionChanged(i)}}}exports.ObservableArray=ObservableArray;!function(e){e[e.Natural=0]="Natural";e[e.First=1]="First";e[e.Last=2]="Last"}(SortNulls=exports.SortNulls||(exports.SortNulls={}));const _OBJ_DEPTH=2;class CollectionView{constructor(e,t){this._srcRaw=null;this._src=null;this._ncc=null;this._view=null;this._pgView=null;this._groups=null;this._fullGroups=null;this._digest="";this._idx=-1;this._filter=null;this._filters=new ObservableArray;this._srtDsc=new ObservableArray;this._grpDesc=new ObservableArray;this._newItem=null;this._edtItem=null;this._edtClone=null;this._committing=!1;this._canceling=!1;this._pendingRefresh=!1;this._pendingRemove=!1;this._pgSz=0;this._pgIdx=0;this._updating=0;this._stableSort=!1;this._srtNulls=SortNulls.Last;this._canFilter=!0;this._canGroup=!0;this._canSort=!0;this._canAddNew=!0;this._canCancelEdit=!0;this._canRemove=!0;this._canChangePage=!0;this._refreshOnEdit=!0;this._trackChanges=!1;this._chgAdded=new ObservableArray;this._chgRemoved=new ObservableArray;this._chgEdited=new ObservableArray;this._orgVals=window.Map?new Map:null;this._srtCvt=null;this._srtCmp=null;this._getError=null;this._keepCurrentItem=null;this._initializing=!1;this.collectionChanged=new Event;this.sourceCollectionChanging=new Event;this.sourceCollectionChanged=new Event;this.currentChanged=new Event;this.currentChanging=new Event;this.pageChanged=new Event;this.pageChanging=new Event;this._srtDsc.collectionChanged.addHandler(()=>{this._srtDsc.forEach(e=>{assert(e instanceof SortDescription,"sortDescriptions array must contain SortDescription objects.")});this.canSort&&this._commitAndRefresh()});this._grpDesc.collectionChanged.addHandler(()=>{this._grpDesc.forEach(e=>{assert(e instanceof GroupDescription,"groupDescriptions array must contain GroupDescription objects.")});this.canGroup&&this._commitAndRefresh()});this._filters.collectionChanged.addHandler(()=>{this._filters.forEach(e=>{assert(isFunction(e),"filters array must contain IPredicate functions.")});this.canFilter&&this._commitAndRefresh()});this.sourceCollection=e||new ObservableArray;if(t){this._initializing=!0;this.deferUpdate(()=>{copy(this,t)});this._initializing=!1}null==this._keepCurrentItem&&(this._keepCurrentItem=!0)}_copy(e,t){switch(e){case"sortDescriptions":let e=this.sortDescriptions;e.deferUpdate(()=>{e.clear();asArray(t).forEach(t=>{isString(t)?t=new SortDescription(t,!0):t instanceof SortDescription||!t.property||(t=new SortDescription(t.property,t.ascending));e.push(t)})});return!0;case"groupDescriptions":let s=this.groupDescriptions;s.deferUpdate(()=>{s.clear();t.forEach(e=>{isString(e)&&(e=new PropertyGroupDescription(e));s.push(e)})});return!0;case"currentItem":this.currentItem=t;return!0}return!1}get calculatedFields(){return this._calcFields}set calculatedFields(e){if(e&&!window.Proxy){console.warn("** Calculated fields require Proxy (see https://www.npmjs.com/package/proxy-polyfill).");e=null}if(e!=this._calcFields){this._calcFields=e;let t=this._srcRaw;this._srcRaw=null;this.sourceCollection=t}}get newItemCreator(){return this._itemCreator}set newItemCreator(e){this._itemCreator=asFunction(e)}get sortConverter(){return this._srtCvt}set sortConverter(e){e!=this._srtCvt&&(this._srtCvt=asFunction(e,!0))}get sortComparer(){return this._srtCmp}set sortComparer(e){e!=this._srtCmp&&(this._srtCmp=asFunction(e,!0))}get useStableSort(){return this._stableSort}set useStableSort(e){if(e!=this._stableSort){this._stableSort=asBoolean(e);this.refresh()}}get sortNulls(){return this._srtNulls}set sortNulls(e){if((e=asEnum(e,SortNulls))!=this._srtNulls){this._srtNulls=e;this.refresh()}}get sortNullsFirst(){return this.sortNulls!=SortNulls.Last}set sortNullsFirst(e){_deprecated("sortNullsFirst","sortNulls");this.sortNulls=asBoolean(e)?SortNulls.First:SortNulls.Last}getAggregate(e,t,s){return getAggregate(e,s?this._pgView:this._view,t)}get trackChanges(){return this._trackChanges}set trackChanges(e){this._trackChanges=asBoolean(e)}get refreshOnEdit(){return this._refreshOnEdit}set refreshOnEdit(e){this._refreshOnEdit=asBoolean(e)}get itemsAdded(){return this._chgAdded}get itemsRemoved(){return this._chgRemoved}get itemsEdited(){return this._chgEdited}clearChanges(){this._chgAdded.clear();this._chgRemoved.clear();this._chgEdited.clear();this._orgVals&&this._orgVals.clear()}implementsInterface(e){switch(e){case"ICollectionView":case"IEditableCollectionView":case"IPagedCollectionView":case"INotifyCollectionChanged":return!0}return!1}get getError(){return this._getError}set getError(e){if(this._getError!=e){this._getError=asFunction(e);this._raiseCollectionChanged()}}onCollectionChanged(e=NotifyCollectionChangedEventArgs.reset){e.action!=NotifyCollectionChangedAction.Change||this._committing||this._canceling||e.item==this.currentEditItem||e.item==this.currentAddItem||this._trackItemChanged(e.item);this._updating||this.collectionChanged.raise(this,e)}_raiseCollectionChanged(e=NotifyCollectionChangedAction.Reset,t,s){let i=new NotifyCollectionChangedEventArgs(e,t,s);this.onCollectionChanged(i)}onSourceCollectionChanging(e){this.sourceCollectionChanging.raise(this,e);return!e.cancel}onSourceCollectionChanged(e){this.sourceCollectionChanged.raise(this,e)}get canFilter(){return this._canFilter}set canFilter(e){this._canFilter=asBoolean(e)}get canGroup(){return this._canGroup}set canGroup(e){this._canGroup=asBoolean(e)}get canSort(){return this._canSort}set canSort(e){this._canSort=asBoolean(e)}get currentItem(){return this._pgView&&this._idx>-1&&this._idx<this._pgView.length?this._pgView[this._idx]:null}set currentItem(e){this.moveCurrentTo(e)}get currentPosition(){return this._idx}set currentPosition(e){this.moveCurrentToPosition(asNumber(e))}get filter(){return this._filter}set filter(e){if(this._filter!=e){this._filter=asFunction(e);this.canFilter&&this.refresh()}}get filters(){return this._filters}get groupDescriptions(){return this._grpDesc}get groups(){return this._groups}get isEmpty(){return!this._pgView||!this._pgView.length}get sortDescriptions(){return this._srtDsc}get sourceCollection(){return this._src}set sourceCollection(e){if(e!=this._srcRaw){if(!this.onSourceCollectionChanging(new CancelEventArgs))return;let t=this.currentPosition;this.commitEdit();null!=this._ncc&&this._ncc.collectionChanged.removeHandler(this._sourceChanged);this._srcRaw=e;this._src=asArray(e,!1);this._calcFields&&(this._src=_getCalculatedArray(this._src,this._calcFields));this._ncc=tryCast(this._src,"INotifyCollectionChanged");this._ncc&&this._ncc.collectionChanged.addHandler(this._sourceChanged,this);this.clearChanges();this.refresh();this.moveCurrentToFirst();this.onSourceCollectionChanged();this.currentPosition<0&&t>-1&&this.onCurrentChanged()}}_sourceChanged(e,t){this._updating<=0&&this.refresh()}contains(e){return this._pgView.indexOf(e)>-1}moveCurrentTo(e){return this.moveCurrentToPosition(this._pgView.indexOf(e))}moveCurrentToFirst(){return this.moveCurrentToPosition(0)}moveCurrentToLast(){return this.moveCurrentToPosition(this._pgView.length-1)}moveCurrentToPrevious(){return this._idx>0&&this.moveCurrentToPosition(this._idx-1)}moveCurrentToNext(){return this.moveCurrentToPosition(this._idx+1)}moveCurrentToPosition(e){if(e>=-1&&e<this._pgView.length&&e!=this._idx){let t=new CancelEventArgs;if(this.onCurrentChanging(t)){let t=this._pgView[e],s=_getTargetObject(t),i=this._edtItem,n=this._newItem;i&&i!=t&&i!=s?this.commitEdit():n&&n!=t&&n!=s&&this.commitNew();this._idx=e;this.onCurrentChanged()}}return this._idx==e}refresh(){if(this._newItem||this._edtItem||this._updating>0)this._pendingRefresh=!0;else{let e=this.currentItem;this._performRefresh();this.onCollectionChanged();e==this.currentItem||this._initializing||this.onCurrentChanged()}}_commitAndRefresh(){if(this.currentEditItem||this.currentAddItem){this._pendingRefresh=!0;this.commitEdit()}else this.refresh()}_performRefresh(){if(this._updating>0){this._pendingRefresh=!0;return}this._pendingRefresh=!1;this._pendingRemove=!1;let e=this.currentItem;this._view=this._src?this._performFilter(this._src):[];if(this.canSort&&this._srtDsc.length>0){this._view==this._src&&(this._view=this._src.slice());this._performSort(this._view)}this._groups=this.canGroup?this._createGroups(this._view):null;this._fullGroups=this._groups;this._groups&&(this._view=this._mergeGroupItems(this._groups));this._pgIdx=clamp(this._pgIdx,0,this.pageCount-1);this._pgView=this._getPageView();if(this._groups&&this.pageCount>1){this._groups=this._createGroups(this._pgView);this._mergeGroupItems(this._groups)}let t=this._keepCurrentItem&&null!=e?this._pgView.indexOf(e):-1;t<0&&(t=Math.min(this._idx,this._pgView.length-1));this._idx=t;this._digest=this._getGroupsDigest(this.groups)}_performSort(e){if(this._stableSort){let t=e.map((e,t)=>({item:e,index:t})),s=this._compareItems();t.sort((e,t)=>{let i=s(e.item,t.item);return 0==i?e.index-t.index:i});for(let s=0;s<e.length;s++)e[s]=t[s].item}else e.sort(this._compareItems())}_compareItems(){let e=this._srtDsc,t=this._srtCvt,s=this._srtCmp,i=CollectionView._collator,n=!0,r=0;return(o,l)=>{for(let a=0;a<e.length;a++){let h=e[a],c=h._bnd.getValue(o),u=h._bnd.getValue(l);if(t){c=t(h,o,c,n);u=t(h,l,u,!1);n=!1}if(s&&null!=(r=s(c,u))){if(0!=r)return h.ascending?+r:-r}else{c!=c&&(c=null);u!=u&&(u=null);if(c!==u&&(null==c||null==u))switch(this._srtNulls){case SortNulls.First:return null==c?-1:1;case SortNulls.Last:return null==c?1:-1;default:r=null==c?-1:1;return h.ascending?+r:-r}if("string"==typeof c&&"string"==typeof u){if(i){if(0!=(r=i.compare(c,u)))return h.ascending?+r:-r;continue}let e=c.toLowerCase(),t=u.toLowerCase();if(e!=t){c=e;u=t}}if(0!=(r=c<u?-1:c>u?1:0))return h.ascending?+r:-r}}return 0}}_performFilter(e){return this.canFilter&&this._filter||this._filters.length?e.filter(this._filterItem,this):e}_filterItem(e){var t=!this.canFilter||!this._filter||this._filter(e);for(let s=0;s<this._filters.length&&t;s++)t=this._filters[s](e);return t}onCurrentChanged(e){this.currentChanged.raise(this,e)}onCurrentChanging(e){this.currentChanging.raise(this,e);return!e.cancel}get items(){return this._pgView}beginUpdate(){this._updating++}endUpdate(e=!0){this._updating--;e&&(this._pendingRefresh=!0);if(this._updating<=0){this._pendingRefresh&&this.refresh();if(this._pendingRemove){this._pendingRemove=!1;this._raiseCollectionChanged()}}}get isUpdating(){return this._updating>0}deferUpdate(e,t=!0){try{this.beginUpdate();e()}finally{this.endUpdate(t)}}get canAddNew(){return this._canAddNew}set canAddNew(e){if(e!=this._canAddNew){this._canAddNew=asBoolean(e);this._raiseCollectionChanged()}}get canCancelEdit(){return this._canCancelEdit}set canCancelEdit(e){this._canCancelEdit=asBoolean(e)}get canRemove(){return this._canRemove}set canRemove(e){this._canRemove=asBoolean(e)}get currentAddItem(){return this._newItem}get currentEditItem(){return this._edtItem}get isAddingNew(){return null!=this._newItem}get isEditingItem(){return null!=this._edtItem}editItem(e){if(e!=this._edtItem&&this.moveCurrentTo(e)){this.commitEdit();this._edtItem=e;this._edtClone=this._extend({},this._edtItem)}}commitEdit(){let e=this._edtItem,t=this._edtClone;if(null!=e){this._committing=!0;let s=this._getChangedFields(e,t),i=this._pendingRefresh;this._edtItem=null;this._edtClone=null;let n=this._pgView.indexOf(e),r=this._digest;this._needRefresh(s)&&this._refreshOnEdit&&this._performRefresh();s&&this._trackItemChanged(e,t);this._pgView.indexOf(e)!=n||r!=this._digest||i?this._raiseCollectionChanged():this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,e,n);this.commitNew();this._committing=!1;if(this.sourceCollection instanceof ObservableArray){this._updating++;let t=new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Change,e);this.sourceCollection.onCollectionChanged(t);this._updating--}}}cancelEdit(){let e=this._edtItem;if(null!=e){this._edtItem=null;if(!this.canCancelEdit)return;let t=this._src.indexOf(e);if(t>=0&&this._edtClone){this._extend(this._src[t],this._edtClone);this._edtClone=null;this._canceling=!0;this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,e,t);this._canceling=!1;if(this._pendingRefresh&&this._refreshOnEdit){this._performRefresh();this._raiseCollectionChanged()}}}}addNew(e,t=!1){this.commitEdit();if(!this.canAddNew)return null;let s=this.sourceCollection;null==e&&(e=this.newItemCreator?this.newItemCreator():s&&s.length?new s[0].constructor:{});if(null!=e){this._updating++;s.push(e);this._updating--;e=s[s.length-1];this._newItem=e;this._pgView!=this._src&&this._pgView.push(e);if(this.groups&&this.groups.length){let t=this.groups[this.groups.length-1];t.items.push(e);for(;t.groups&&t.groups.length;)(t=t.groups[t.groups.length-1]).items.push(e)}this._raiseCollectionChanged(NotifyCollectionChangedAction.Add,e,this._pgView.length-1);this.moveCurrentTo(e);t&&this.commitNew()}return this._newItem}commitNew(){let e=this._newItem;if(null!=e){this._newItem=null;let t=this._pgView.indexOf(e),s=this._digest;this._refreshOnEdit&&this._performRefresh();if(this._trackChanges){let t=this._chgEdited.indexOf(e);t>-1&&this._chgEdited.removeAt(t);this._chgAdded.indexOf(e)<0&&this._chgAdded.push(e)}this._pgView.indexOf(e)!=t||s!=this._digest||this.calculatedFields?this._raiseCollectionChanged():this._raiseCollectionChanged(NotifyCollectionChangedAction.Change,e,t)}}cancelNew(){let e=this._newItem;null!=e&&this.remove(e)}remove(e){let t=e==this._newItem;t&&(this._newItem=null);e==this._edtItem&&this.cancelEdit();if(!this.canRemove)return;let s=this._src.indexOf(e);if(s>-1){let i=this._view.indexOf(e)<0,n=this.currentItem;this._updating++;this._src.splice(s,1);this._updating--;let r=this._digest;if(this._refreshOnEdit)this._performRefresh();else{this._updating>0&&(this._pendingRemove=!0);let t=this._pgView.indexOf(e);t>=0&&this._pgView.splice(t,1)}if(this._trackChanges){let s=this._chgAdded.indexOf(e);s>-1&&this._chgAdded.removeAt(s);let i=this._chgEdited.indexOf(e);i>-1&&this._chgEdited.removeAt(i);this._chgRemoved.indexOf(e)<0&&!t&&s<0&&this._chgRemoved.push(e)}let o=this.sortDescriptions.length>0,l=this.pageSize>0&&this._pgIdx>-1;o||l||r!=this._getGroupsDigest(this.groups)?this._raiseCollectionChanged():i||this._raiseCollectionChanged(NotifyCollectionChangedAction.Remove,e,s);this.currentItem!==n&&this.onCurrentChanged()}}removeAt(e){e=asInt(e);this.remove(this._pgView[e])}_trackItemChanged(e,t){if(this._trackChanges){let s=this.sourceCollection;if(s&&s.indexOf(e)>-1){let s=this._orgVals,i=s?s.get(e):null;if(t&&!i&&s){s.set(e,t);i=t}let n=this._chgEdited.indexOf(e),r=NotifyCollectionChangedAction.Change;if(i&&this._sameContent(e,i)&&n>-1){this._chgEdited.removeAt(n);s.delete(e);return}if(n<0&&this._chgAdded.indexOf(e)<0)this._chgEdited.push(e);else if(n>-1){let t=new NotifyCollectionChangedEventArgs(r,e,n);this._chgEdited.onCollectionChanged(t)}else if((n=this._chgAdded.indexOf(e))>-1){let t=new NotifyCollectionChangedEventArgs(r,e,n);this._chgAdded.onCollectionChanged(t)}}}}_extend(e,t,s=_OBJ_DEPTH){for(let i in t)try{let n=t[i];if(s>0&&isObject(n)){e[i]={};this._extend(e[i],n,s-1)}else e[i]=n}catch(e){}return e}_getChangedFields(e,t,s=_OBJ_DEPTH){assert(null!=t&&null!=e,"Two objects expected.");let i={};for(let n in t)try{this._sameValue(e[n],t[n],s)||(i[n]=!0)}catch(e){}for(let n in e)try{i[n]||this._sameValue(e[n],t[n],s)||(i[n]=!0)}catch(e){}let n=Object.keys(i);return n.length?n:null}_sameValue(e,t,s=_OBJ_DEPTH){return!(e!==t&&!DateTime.equals(e,t))||!(!isObject(e)||!isObject(t))&&(!(s>0)||null==this._getChangedFields(e,t,s-1))}_sameContent(e,t){return null==this._getChangedFields(e,t)}_needRefresh(e){if(this._pendingRefresh)return!0;if(!e)return!1;if(this._filter)return!0;for(let t=0;t<this._srtDsc.length;t++){let s=this._getBindingRoot(this._srtDsc[t].property);if(e.indexOf(s)>-1)return!0}for(let t=0;t<this._grpDesc.length;t++){let s=this._grpDesc[t];if(!(s instanceof PropertyGroupDescription))return!0;let i=this._getBindingRoot(s.propertyName);if(e.indexOf(i)>-1)return!0}return!1}_getBindingRoot(e){let t=e.indexOf(".");return t>-1?e.substr(0,t):e}get canChangePage(){return this._canChangePage}set canChangePage(e){this._canChangePage=asBoolean(e)}get isPageChanging(){return!1}get itemCount(){return this._pgView.length}get pageIndex(){return this._pgIdx}get pageSize(){return this._pgSz}set pageSize(e){if(e!=this._pgSz){this._pgSz=asInt(e);this.refresh()}}get totalItemCount(){return this._view.length}get pageCount(){return this.pageSize?Math.ceil(this.totalItemCount/this.pageSize):1}moveToFirstPage(){return this.moveToPage(0)}moveToLastPage(){return this.moveToPage(this.pageCount-1)}moveToPreviousPage(){return this.moveToPage(this.pageIndex-1)}moveToNextPage(){return this.moveToPage(this.pageIndex+1)}moveToPage(e){let t=clamp(e,0,this.pageCount-1);if(t!=this._pgIdx){if(!this.canChangePage)return!1;let e=new PageChangingEventArgs(t);if(this.onPageChanging(e)&&this.onCurrentChanging(e)){this.commitEdit();this.commitNew();let e=this.currentItem;this._pgIdx=t;this._pgView=this._getPageView();this._idx=0;if(this.groupDescriptions&&0!=this.groupDescriptions.length)this.refresh();else{this.onCollectionChanged();e!=this.currentItem&&this.onCurrentChanged()}this.onPageChanged()}}return this._pgIdx==e}onPageChanged(e){this.pageChanged.raise(this,e)}onPageChanging(e){this.pageChanging.raise(this,e);return!e.cancel}_getFullGroup(e){let t=this._getGroupByPath(this._fullGroups,e.level,e._path);null!=t&&(e=t);return e}_getGroupByPath(e,t,s){if(e)for(let i=0;i<e.length;i++){let n=e[i];if(n.level==t&&n._path==s)return n;if(n.level<t&&0==s.indexOf(n._path)&&null!=(n=this._getGroupByPath(n.groups,t,s)))return n}return null}_getPageView(){if(this.pageSize<=0||this._pgIdx<0)return this._view;let e=this._pgSz*this._pgIdx,t=Math.min(e+this._pgSz,this._view.length);return this._view.slice(e,t)}_createGroups(e){if(!this._grpDesc||!this._grpDesc.length)return null;let t=[],s={},i=null;e.forEach(e=>{let n=t,r=this._grpDesc.length,o="";for(let t=0;t<r;t++){let l=this._grpDesc[t],a=l.groupNameFromItem(e,t),h=t==r-1;if(!(i=s[o])&&isPrimitive(a)){i={};s[o]=i}let c=this._getGroup(l,n,i,a,t,h);o+="/"+a;c._path=o;h&&c.items.push(e);n=c.groups}});return t}_getGroupsDigest(e){let t="";for(let s=0;null!=e&&s<e.length;s++){let i=e[s];t+="{"+i.name+":"+(i.items?i.items.length:"*");if(i.groups.length>0){t+=",";t+=this._getGroupsDigest(i.groups)}t+="}"}return t}_mergeGroupItems(e){let t=[];for(let s=0;s<e.length;s++){let i=e[s];if(!i._isBottomLevel){let e=this._mergeGroupItems(i.groups);for(let t=0,s=e.length;t<s;t++)i._items.push(e[t])}for(let e=0,s=i._items.length;e<s;e++)t.push(i._items[e])}return t}_getGroup(e,t,s,i,n,r){let o;if(s&&isPrimitive(i)){if(o=s[i])return o}else for(let s=0;s<t.length;s++)if(e.namesMatch(t[s].name,i))return t[s];let l=new CollectionViewGroup(e,i,n,r);t.push(l);s&&(s[i]=l);return l}}CollectionView._collator="undefined"!=typeof window&&window.Intl&&Intl.Collator?new Intl.Collator:null;exports.CollectionView=CollectionView;class CollectionViewGroup{constructor(e,t,s,i){this._gd=e;this._name=t;this._level=s;this._isBottomLevel=i;this._groups=[];this._items=[]}get name(){return this._name}get level(){return this._level}get isBottomLevel(){return this._isBottomLevel}get items(){return this._items}get groups(){return this._groups}get groupDescription(){return this._gd}getAggregate(e,t,s){let i=tryCast(s,CollectionView);return getAggregate(e,(i?i._getFullGroup(this):this).items,t)}}exports.CollectionViewGroup=CollectionViewGroup;exports.controlBaseClass="undefined"!=typeof window&&window["wj-control-is-element"]?HTMLElement:Object;var __isES6Mode=!1;try{let e=class __c{};e.prototype=Array.prototype;__isES6Mode=e.prototype!==Array.prototype}catch(e){__isES6Mode=!0}var PopupPosition,__callSuper=__isES6Mode||exports.controlBaseClass!==Object;class ControlBase extends exports.controlBaseClass{constructor(){__callSuper&&super()}}exports.ControlBase=ControlBase;class Control extends ControlBase{constructor(e,t=null,s=!1){super();this._listeners=[];this._pristine=!0;this._focus=!1;this._updating=0;this._fullUpdate=!1;this.gotFocus=new Event;this.lostFocus=new Event;this.invalidInput=new Event;this.refreshing=new Event;this.refreshed=new Event;this._updateWme();assert(null==Control.getControl(e),"Element is already hosting a control.");let i=getElement(e);assert(null!=i,"Cannot find the host element.");this._orgTabIndex=i.hasAttribute("tabindex")?i.tabIndex:0;this._orgOuter=i.outerHTML;this._orgInner=i.innerHTML;this._orgTag=i.tagName;this._orgAtts=i.attributes;"INPUT"!=i.tagName&&"SELECT"!=i.tagName||(i=this._replaceWithDiv(i));this._e=i;i[Control._CTRL_KEY]=this;let n=this.addEventListener.bind(this);if(1==s){this._szCtl=new Size(i.offsetWidth,i.offsetHeight);let e=window.ResizeObserver,t=null;e&&(t=this._szObserver=new e(e=>this._resizeObserverCallback(e)));t?t.observe(i):n(window,"resize",this._handleResize.bind(this))}let r=this._handleFocusBlur.bind(this);n(i,"focus",r,!0);n(i,"blur",r,!0);let o=this._handleDisabled.bind(this);n(i,"mousedown",o,!0);n(i,"mouseup",o,!0);n(i,"click",o,!0);n(i,"dblclick",o,!0);n(i,"wheel",o,getEventOptions(!0,!0));n(i,"keydown",e=>{this.isDisabled&&e.keyCode!=Key.Tab&&e.preventDefault()});0==Control._ctlCnt&&_detectTouch(!0);Control._ctlCnt++}getTemplate(){for(let e=Object.getPrototypeOf(this);e;e=Object.getPrototypeOf(e)){let t=e.constructor.controlTemplate;if(t)return t}return null}applyTemplate(e,t,s,i){let n=this._e;e&&addClass(n,e);let r=null;t&&(r=createElement(t,n));let o=n.querySelectorAll("a.wj-btn");for(var l=0;l<o.length;l++){let e=o[l];setAttribute(e,"role","button",!0);setAttribute(e,"href","",!0);setAttribute(e,"draggable",!1,!0)}let a=n.querySelectorAll("button");for(l=0;l<a.length;l++)setAttribute(a[l],"type","button",!0);let h=n.querySelectorAll("input"),c=1==h.length?h[0]:null;if(c){let e=Control._rxInputAtts;this._copyAttributes(c,n.attributes,e);this._copyAttributes(c,this._orgAtts,e)}if(c&&n.id){let e=n;for(;e.parentElement;)e=e.parentElement;let t=e.querySelector('label[for="'+n.id+'"]');if(t instanceof HTMLLabelElement){let e=getUniqueId(n.id+"_input");c.id=e;t.htmlFor=e}}if(c){let e=c.value,t=!0,s=!1,i=document.createEvent("HTMLEvents");i.initEvent("change",!0,!1);this.gotFocus.addHandler(()=>{t=!1;s=!0;e=c.value});this.addEventListener(n,"focusin",i=>{if(t){s=!0;t=!1;e=c.value}});this.addEventListener(c,"input",()=>{this._pristine=!1;setTimeout(()=>{e=c.value})});this.addEventListener(c,"change",t=>{t.isTrusted&&(e=c.value)});const leave=()=>{if(!this._containsFocus()){t=!0;if(this._pristine){this._pristine=!1;this._updateState()}if(s&&e!=c.value){e=c.value;c.dispatchEvent(i)}s=!1}};this.addEventListener(n,"blur",()=>{leave()});this.lostFocus.addHandler(()=>{leave()})}c?n.tabIndex=-1:n.getAttribute("tabindex")||(n.tabIndex=0);this._updateState();if(s)for(let e in s){let t=s[e];this[e]=r.querySelector('[wj-part="'+t+'"]');null==this[e]&&r.getAttribute("wj-part")==t&&(this[e]=r);if(null==this[e])throw'Missing template part: "'+t+'"';if(t==i){let t="name",s=n.attributes[t];s&&s.value&&this[e].setAttribute(t,s.value);t="accesskey";if((s=n.attributes[t])&&s.value){this[e].setAttribute(t,s.value);n.removeAttribute(t)}}}return r}dispose(){if(!this._e)return;let e=this._e.querySelectorAll(".wj-control");for(let t=0;t<e.length;t++){let s=Control.getControl(e[t]);s&&s.dispose()}if(this._toInv){clearTimeout(this._toInv);this._toInv=null}if(this._toFocus){clearTimeout(this._toFocus);this._toFocus=null}let t=this._szObserver;t&&t.disconnect();this.removeEventListener();for(let e in this)if(e.length>2&&0==e.indexOf("on")){let t=this[e[2].toLowerCase()+e.substr(3)];t instanceof Event&&t.removeAllHandlers()}let s=this.collectionView;if(s instanceof CollectionView)for(let e in s){let t=s[e];t instanceof Event&&t.removeHandler(null,this)}if(this._e.parentNode){null!=this._orgOuter&&(this._e.outerHTML=this._orgOuter);this._e.innerHTML=this._orgInner}this._e[Control._CTRL_KEY]=null;this._e=this._orgOuter=this._orgTag=this._szObserver=null;Control._ctlCnt--;0==Control._ctlCnt&&_detectTouch(!1);if(Control._ctlInvalidInput===this){if(Control._toInvalidInput){clearTimeout(Control._toInvalidInput);Control._toInvalidInput=null}if(Control._toClearCtlInvalid){clearTimeout(Control._toClearCtlInvalid);Control._toClearCtlInvalid=null}Control._ctlInvalidInput=null}}static getControl(e){let t=getElement(e);return t?asType(t[Control._CTRL_KEY],Control,!0):null}get hostElement(){return this._e}get rightToLeft(){null==this._rtlDir&&(this._rtlDir=!!this._e&&"rtl"==getComputedStyle(this._e).direction);return this._rtlDir}focus(){let e=this._e;e&&e.offsetHeight&&(this.isDisabled||!(e.tabIndex>=0)&&moveFocus(e,0)||e.focus())}containsFocus(){return this._containsFocusImpl(getActiveElement())}_containsFocus(){return this._containsFocusImpl(_getActiveElement())}_containsFocusImpl(e){return contains(this._e,e,!0)}invalidate(e=!0){this._rtlDir=null;this._fullUpdate=this._fullUpdate||e;if(this._toInv){clearTimeout(this._toInv);this._toInv=null}this.isUpdating||(this._toInv=setTimeout(()=>{this.refresh(this._fullUpdate);this._toInv=null},Control._REFRESH_INTERVAL))}refresh(e=!0){if(!this.isUpdating){this.onRefreshing();this.refreshed.hasHandlers&&setTimeout(()=>{this.onRefreshed()})}if(!this.isUpdating&&this._toInv){clearTimeout(this._toInv);this._toInv=null;this._fullUpdate=!1}this._updateState();this._updateWme()}static invalidateAll(e){e||(e=document.body);let t=e.children;if(t)for(let e=0;e<t.length;e++)Control.invalidateAll(t[e]);let s=Control.getControl(e);s&&s.invalidate()}static refreshAll(e){e||(e=document.body);if(e.children)for(let t=0;t<e.children.length;t++)Control.refreshAll(e.children[t]);let t=Control.getControl(e);t&&t.refresh()}static disposeAll(e){let t=Control.getControl(e);if(t)t.dispose();else if(e.children)for(let t=0;t<e.children.length;t++)Control.disposeAll(e.children[t])}beginUpdate(){this._updating++}endUpdate(){this._updating--;this._updating<=0&&this.invalidate()}get isUpdating(){return this._updating>0}deferUpdate(e){try{this.beginUpdate();e()}finally{this.endUpdate()}}get isTouching(){return Control._touching}get tabOrder(){return this._orgTabIndex}set tabOrder(e){this._setTabOrder(e)}_setTabOrder(e){let t=this._e;this._orgTabIndex=e;let s=t.querySelectorAll("input"),i=1===s.length?s[0]:null;t.tabIndex=this.isDisabled||i?-1:this._orgTabIndex;i&&(i.tabIndex=this._orgTabIndex)}get isDisabled(){return this._e&&null!=this._e.getAttribute("disabled")}set isDisabled(e){this._setIsDisabled(e)}_setIsDisabled(e){if((e=!!asBoolean(e,!0))!=this.isDisabled){let t=this._e;if(t){let s="disabled";toggleClass(t,"wj-state-disabled",e);setAttribute(t,s,e?s:null);t.tabIndex=this.isDisabled||1===t.querySelectorAll("input").length?-1:this._orgTabIndex;let i=t.querySelectorAll("input,textarea,button,command,fieldset,keygen,optgroup,option,select"),n=Control._DSBL_KEY;for(let t=0;t<i.length;t++){let s=i[t];if(e){s[n]=s.disabled;s.disabled=!0}else{if(!!closest(s,".wj-control.wj-state-disabled")){s[n]=s.disabled;s.disabled=!0}else{let e=s[n];isBoolean(e)||(e=!1);s.disabled=e;delete s[n]}}}}}}initialize(e){copy(this,e)}addEventListener(e,t,s,i,n){if(e){null==i&&(i=!1);isBoolean(i)&&null==n&&(t.indexOf("touch")>-1||t.indexOf("wheel")>-1)&&(n=!1);let r=isBoolean(i)&&isBoolean(n)?getEventOptions(i,n):i;e.addEventListener(t,s,r);this._listeners.push({target:e,type:t,fn:s,capture:i})}}removeEventListener(e,t,s,i){let n=0;for(let r=0;r<this._listeners.length;r++){let o=this._listeners[r];if(!(null!=e&&e!=o.target||null!=t&&t!=o.type||null!=s&&s!=o.fn||null!=i&&i!=o.capture)){o.target.removeEventListener(o.type,o.fn,o.capture);this._listeners.splice(r,1);r--;n++}}return n}onGotFocus(e){this.gotFocus.raise(this,e)}onLostFocus(e){this.lostFocus.raise(this,e)}onInvalidInput(e){this.invalidInput.raise(this,e);if(e.cancel){let e=Control._FOCUS_INTERVAL+50;if(null==Control._ctlInvalidInput||Control._ctlInvalidInput===this){Control._ctlInvalidInput=this;Control._toInvalidInput&&clearTimeout(Control._toInvalidInput);Control._toClearCtlInvalid&&clearTimeout(Control._toClearCtlInvalid);Control._toInvalidInput=setTimeout(()=>{Control._toInvalidInput=null;this.focus();Control._toClearCtlInvalid=setTimeout(()=>{Control._ctlInvalidInput=null;Control._toClearCtlInvalid=null},e)},e)}}else Control._ctlInvalidInput=null;this._updateState();return!e.cancel}onRefreshing(e){this.refreshing.raise(this,e)}onRefreshed(e){this.refreshed.raise(this,e)}_getProductInfo(){return"B0C3,Control"}_updateWme(){let e=this._getProductInfo(),t=Control._toWme,s=_updateWme;if(isFunction(s)&&!t[e]){t[e]=!0;s(this,Control._licKey)}}_hasPendingUpdates(){return null!=this._toInv}_handleResize(){if(this._e.parentElement){let e=new Size(this._e.offsetWidth,this._e.offsetHeight);if(!e.equals(this._szCtl)){this._szCtl=e;(e.width||e.height)&&this.invalidate()}}}_resizeObserverCallback(e){e.forEach(e=>{let t=Control.getControl(e.target);t&&t._handleResize()})}_handleFocusBlur(){this._toFocus||(this._toFocus=setTimeout(()=>{this._toFocus=null;this._updateFocusState()},Control._FOCUS_INTERVAL))}_updateFocusState(){setTimeout(()=>{let e=EventArgs.empty,t=document.body.querySelectorAll(".wj-state-focused");for(let s=0;s<t.length;s++){let i=Control.getControl(t[s]);if(i&&i._focus&&!i.containsFocus()){removeClass(i._e,"wj-state-focus");i._focus=!1;i._updateState();i.onLostFocus(e)}}let s=getActiveElement();if(s){let t=!0;for(let i=s;i;){let s=Control.getControl(i);if(s&&!s._focus&&s.containsFocus()){if(t){addClass(i,"wj-state-focus");t=!1}s._focus=!0;s._updateState();s.onGotFocus(e)}i=i[Control._OWNR_KEY]||i.parentNode}}})}_updateState(){let e=this.hostElement;if(e){toggleClass(e,"wj-state-focused",this._focus);this._rtlDir="rtl"==getComputedStyle(e).direction;toggleClass(e,"wj-rtl",this._rtlDir);let t=e.querySelector("input");if(t instanceof HTMLInputElement){toggleClass(e,"wj-state-empty",0==t.value.length);toggleClass(e,"wj-state-readonly",t.readOnly);let s=t.validationMessage;toggleClass(e,"wj-state-invalid",!this._pristine&&null!=s&&s.length>0)}}}_handleDisabled(e){if(this.isDisabled||closest(e.target,".wj-state-disabled")){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}}_replaceWithDiv(e){let t=document.createElement("div");e.parentElement.replaceChild(t,e);t.innerHTML=e.innerHTML;this._copyAttributes(t,e.attributes,/id|style|class/i);return t}_copyAttributes(e,t,s){if(e)for(let i=0;i<t.length;i++){let n=t[i].name;n.match(s)&&e.setAttribute(n,t[i].value)}}_getKeyCode(e){let t=e.keyCode;if(this.rightToLeft)switch(t){case Key.Right:t=Key.Left;break;case Key.Left:t=Key.Right}return t}}Control._toWme={};Control._ctlCnt=0;Control._touching=!1;Control._REFRESH_INTERVAL=10;Control._FOCUS_INTERVAL=5;Control._ANIM_DEF_DURATION=400;Control._ANIM_DEF_STEP=35;Control._CLICK_DELAY=800;Control._CLICK_REPEAT=75;Control._CLIPBOARD_DELAY=100;Control._POPUP_ZINDEX=1500;Control._SEARCH_DELAY=500;Control._HOVER_DELAY=400;Control._LEAVE_DELAY=600;Control._DRAG_SCROLL_EDGE=15;Control._DRAG_SCROLL_STEP=20;Control._CTRL_KEY="$WJ-CTRL";Control._OWNR_KEY="$WJ-OWNR";Control._SCRL_KEY="$WJ-SCRL";Control._TTIP_KEY="$WJ-TTIP";Control._DSBL_KEY="$WJ-DSBL";Control._rxInputAtts=/name|tabindex|placeholder|autofocus|autocomplete|autocorrect|autocapitalize|spellcheck|readonly|minlength|maxlength|pattern|type|aria-.+/i;exports.Control=Control;function _detectTouch(e){if("ontouchstart"in window||"onpointerdown"in window){let t=document,s=getEventOptions(!0,!0),i=_handleTouchStart,n=_handleTouchEnd,r=e?t.addEventListener.bind(t):t.removeEventListener.bind(t);if("ontouchstart"in window){r("touchstart",i,s);r("touchend",n,s);r("touchcancel",n,s)}else if("onpointerdown"in window){r("pointerdown",i,s);r("pointerup",n,s);r("pointercancel",n,s)}}}function _handleTouchStart(e){if(null==e.pointerType||"touch"==e.pointerType){if(Control._toTouch){clearTimeout(Control._toTouch);Control._toTouch=null}Control._touching=!0}}function _handleTouchEnd(e){if(null==e.pointerType||"touch"==e.pointerType){Control._toTouch=setTimeout((function(){Control._toTouch=null;Control._touching=!1}),900);if(document.querySelector("ion-app")){let t=e.target;if(closest(t,".wj-dropdown-panel,.wj-dropdown")){t.focus();e.stopPropagation();e.stopImmediatePropagation()}}}}class PrintDocument{constructor(e){this._title=null;this._copyCss=!0;null!=e&&copy(this,e)}get title(){return this._title}set title(e){this._title=asString(e)}get copyCss(){return this._copyCss}set copyCss(e){this._copyCss=asBoolean(e)}addCSS(e){this._css||(this._css=[]);this._css.push(e)}append(e){let t=this._getDocument();if(isString(e))t.write(e);else if(e instanceof Element){e instanceof HTMLElement&&Control.refreshAll(e);let s=e.cloneNode(!0),i=s.querySelectorAll("input");for(let e=0;e<i.length;e++){let t=i[e];switch(t.type){case"checkbox":setAttribute(t,"checked",!!t.checked||null);setAttribute(t,"indeterminate",!!t.indeterminate||null);break;case"radio":setAttribute(t,"checked",!!t.checked||null);break;default:setAttribute(t,"value",t.value||null)}}t.write(s.outerHTML)}else assert(!1,"content should be an HTML string or an Element.")}print(e){if(this._iframe){this._close();setTimeout(()=>{let t=this._iframe.contentWindow,s="onafterprint"in t&&!isFirefox();s&&(t.onafterprint=()=>{this._afterPrint(e)});if(!(isIE()&&null==t.document.body)&&document.queryCommandSupported("print"))t.document.execCommand("print",!0,null);else{t.focus();t.print()}s||this._afterPrint(e)},100)}}_afterPrint(e){document.body.removeChild(this._iframe);this._iframe=null;isFunction(e)&&e()}_getDocument(){if(!this._iframe){let e=this._iframe=document.createElement("iframe");addClass(e,"wj-printdocument");setCss(e,{position:"fixed",left:32e3,top:32e3});document.body.appendChild(e)}return this._iframe.contentDocument}_close(){let e=this._getDocument();e.close();e.title=null!=this.title?this.title:document.title;e.title&&e.title.trim()||(e.title=" ");this._copyCss&&[document.head,document.body].forEach(e=>{let t=e.querySelectorAll("LINK");for(let e=0;e<t.length;e++){let s=t[e];if(s.rel.match(/stylesheet/i)&&(!s.type||s.type.match(/text\/css/i))){let e=httpRequest(s.href,{async:!1});this._addStyle(e.responseText)}}let s=e.querySelectorAll("STYLE");for(let e=0;e<s.length;e++)this._addStyle(s[e].textContent)});if(this._css)for(let t=0;t<this._css.length;t++){let s=e.createElement("style"),i=httpRequest(this._css[t],{async:!1});s.textContent=i.responseText;e.head.appendChild(s)}}_addStyle(e){let t=this._getDocument(),s=t.createElement("style");s.textContent=e;t.head.appendChild(s)}}exports.PrintDocument=PrintDocument;class Clipboard{static copy(e){Clipboard._copyPaste(asString(e),null)}static paste(e){e=asFunction(e);Clipboard._copyPaste(null,e)}static _copyPaste(e,t){let s=getActiveElement(),i=closest(s,".wj-control");for(;i&&Control.getControl(i);)i=i.parentElement;if(i=i||document.body){let n=!1,r=createElement('<textarea class="wj-clipboard">',i,{position:"fixed",opacity:"0"});r.onkeydown=e=>e.preventDefault();r.onchange=e=>e.stopImmediatePropagation();if(isString(e)){r.value=e;r.select();document.execCommand("copy")&&(n=!0)}else{r.select();if(isFunction(t)&&document.execCommand("paste")){t(r.value);n=!0}}setTimeout(()=>{s.focus({preventScroll:!0});(isIE()?setTimeout:(e,t)=>e())(()=>removeChild(r),500);!n&&isFunction(t)&&t(r.value)},Control._CLIPBOARD_DELAY)}}}exports.Clipboard=Clipboard;class _ClickRepeater{constructor(e){this._isDown=!1;this._mousedownBnd=this._mousedown.bind(this);this._mouseupBnd=this._mouseup.bind(this);this._clickBnd=this._click.bind(this);this.element=e;this._connect(!0)}get element(){return this._e}set element(e){this._connect(!1);this._e=asType(e,HTMLElement,!0);this._connect(!0)}get disabled(){return this._disabled}set disabled(e){this._disabled=asBoolean(e)}_connect(e){this._e&&_ClickRepeater._startEvents.forEach(t=>{e?this._e.addEventListener(t,this._mousedownBnd):this._e.removeEventListener(t,this._mousedownBnd)})}_clearTimeouts(){if(this._toRepeat){clearTimeout(this._toRepeat);this._toRepeat=null}if(this._toDelay){clearTimeout(this._toDelay);this._toDelay=null}}_mousedown(e){this._isDown&&this._mouseup(null);if(!this._disabled){this._isDown=!0;_ClickRepeater._stopEvents.forEach(e=>{document.addEventListener(e,this._mouseupBnd)});this._clearTimeouts();this._toDelay=setTimeout(()=>{if(this._isDown){this._click();this._toRepeat=setTimeout(this._clickBnd,Control._CLICK_REPEAT)}},Control._CLICK_DELAY)}}_mouseup(e){this._isDown&&e&&"keydown"!=e.type&&this._clicked&&e.preventDefault();_ClickRepeater._stopEvents.forEach(e=>{document.removeEventListener(e,this._mouseupBnd)});this._clearTimeouts();this._isDown=!1;this._clicked=!1}_click(){this._clicked=!0;this._clearTimeouts();if(this._e){this._e.click();this._isDown&&(this._toRepeat=setTimeout(this._clickBnd,Control._CLICK_REPEAT))}}}_ClickRepeater._startEvents=["mousedown","touchstart"];_ClickRepeater._stopEvents=["mouseup","mouseout","keydown","touchend","touchcancel"];exports._ClickRepeater=_ClickRepeater;!function(e){e[e.Above=0]="Above";e[e.AboveRight=1]="AboveRight";e[e.RightTop=2]="RightTop";e[e.Right=3]="Right";e[e.RightBottom=4]="RightBottom";e[e.BelowRight=5]="BelowRight";e[e.Below=6]="Below";e[e.BelowLeft=7]="BelowLeft";e[e.LeftBottom=8]="LeftBottom";e[e.Left=9]="Left";e[e.LeftTop=10]="LeftTop";e[e.AboveLeft=11]="AboveLeft"}(PopupPosition=exports.PopupPosition||(exports.PopupPosition={}));function showPopup(e,t,s,i,n=!0,r){let o=e.offsetHeight||e.offsetWidth,l=s;(isBoolean(s)||null==s)&&(l=s?PopupPosition.AboveLeft:PopupPosition.BelowLeft);let a=_getPopupParent(t);_addPopupToDOM(e,a);_copyPopupStyles(e,t,n);Control.refreshAll(e);isFirefox()?requestAnimationFrame(()=>{_updatePopupPosition(e,t,l)}):_updatePopupPosition(e,t,l);t instanceof HTMLElement&&(e[Control._OWNR_KEY]=t);if(!o){_hidePopupOnscroll(e,t,r);if(i)return animate(t=>e.style.opacity=t<1?t.toString():"");e.style.opacity=""}return null}exports.showPopup=showPopup;function hidePopup(e,t=!0,s=!1){let i=null;s?i=animate(s=>{e.style.opacity=(1-s).toString();if(1==s){_hidePopup(e,t);e.style.opacity=""}}):_hidePopup(e,t);return i}exports.hidePopup=hidePopup;function _updatePopupPosition(e,t,s){let i=_getReferenceRect(e,t),n=_getPopupOffset(e),r=_getPopupPosition(e,i,s,n),o={position:"absolute",zIndex:Control._POPUP_ZINDEX},l=0==n.x;if(l){o.left=r.x;o.top=r.y}else o.transform="translate("+r.x+"px, "+r.y+"px)";let a=e.getBoundingClientRect().width;setCss(e,o);if(l){let t=a-e.getBoundingClientRect().width;t>0&&(e.style.left=r.x-Math.ceil(t)+"px")}}function _hidePopup(e,t){e.style.display="none";t&&e.parentElement&&setTimeout(()=>{if("none"==e.style.display){removeChild(e);isFunction(t)&&t()}},Control._FOCUS_INTERVAL+50);let s=e[Control._SCRL_KEY];s instanceof Control&&s.dispose();delete e[Control._SCRL_KEY];delete e[Control._OWNR_KEY]}function _isjQueryDialog(e){let t=window.jQuery,s=isFunction(t)?t(e):null;return s&&isFunction(s.dialog)&&hasClass(e,"ui-dialog")}function _getPopupParent(e){let t=document.body;if(e instanceof HTMLElement){if(!contains(document.body,e))return t;for(let s=e;s;s=s.parentElement){if("DIALOG"==s.tagName||"ION-CONTENT"==s.tagName||"fixed"==getComputedStyle(s).position){t=s;break}if(_isjQueryDialog(s)){t=s.querySelector(".ui-dialog-content")||s;break}}}return t}function _addPopupToDOM(e,t){if(!e.offsetHeight||!e.offsetWidth||e.parentElement!=t){setCss(e,{opacity:"0",position:"fixed",left:0,top:0,transform:"",display:""});t.appendChild(e)}}function _getPopupOffset(e){let t=document.body,s=document.documentElement,i=e.parentElement,n=new Point(t.scrollLeft||pageXOffset,t.scrollTop||pageYOffset);if(i!=t){let r=i==t?s:e.offsetParent||i;r==t&&(r=i);if(r){let e=r.getBoundingClientRect();n=new Point(r.scrollLeft-e.left,r.scrollTop-e.top)}}if(i instanceof HTMLElement){let e=getComputedStyle(i);n.x-=parseFloat(e.borderLeftWidth);n.y-=parseFloat(e.borderTopWidth)}return n}function _copyPopupStyles(e,t,s){if(t instanceof HTMLElement&&s){let i=s instanceof HTMLElement?s:t,n=getComputedStyle(i);1==new Color(n.backgroundColor).a&&setCss(e,{color:n.color,backgroundColor:n.backgroundColor,fontFamily:n.fontFamily,fontSize:n.fontSize,fontWeight:n.fontWeight,fontStyle:n.fontStyle})}}function _hidePopupOnscroll(e,t,s){let i=t instanceof MouseEvent?t.target:t;if(i instanceof HTMLElement&&i.parentElement!=document.body){let n=Date.now(),r=i.getBoundingClientRect(),o=new Control(document.createElement("div"));e[Control._SCRL_KEY]=o;o.addEventListener(document,"scroll",l=>{if(l.target!=e.parentElement&&Date.now()-n>100&&contains(document,i)&&!contains(e,l.target)&&(l.target!=document||null!=t&&"fixed"==e.style.position)){let t=i.getBoundingClientRect(),n=Math.abs(t.left-r.left),l=Math.abs(t.top-r.top);if(n>1||l>1){isFunction(s)&&s();_hidePopup(e,!0);o.dispose()}}},!0)}}function _getPopupPosition(e,t,s,i){let n=document.documentElement,r=n.clientWidth,o=n.clientHeight,l=PopupPosition;switch(s){case l.AboveLeft:case l.AboveRight:case l.BelowLeft:case l.BelowRight:if(t){let s=t.width;if(s){isIE()&&(s-=e.offsetWidth-e.clientWidth);e.style.minWidth=s+"px"}}}let a=getComputedStyle(e),h=parseFloat(a.marginTop)+parseFloat(a.marginBottom),c=parseFloat(a.marginLeft)+parseFloat(a.marginRight),u=new Size(e.offsetWidth+c,e.offsetHeight+h),d=new Point((r-u.width)/2,Math.round((o-u.height)/2*.7));if(t){"rtl"==a.direction&&(s=_getRtlPosition(s));let e=t.left,i=r-t.right;d.x=t.left;switch(s){case l.Above:case l.Below:d.x=t.left+(t.width-u.width)/2;break;case l.AboveLeft:case l.BelowLeft:d.x=t.left;break;case l.AboveRight:case l.BelowRight:d.x=t.right-u.width;break;case l.Left:case l.LeftTop:case l.LeftBottom:d.x=e>=u.width||e>=i?t.left-u.width:t.right;break;case l.RightTop:case l.RightBottom:case l.Right:d.x=i>=u.width||i>=e?t.right:t.left-u.width}let n=t.top,h=o-t.bottom;switch(s){case l.Above:case l.AboveLeft:case l.AboveRight:d.y=n>u.height||n>h?t.top-u.height:t.bottom;break;case l.Below:case l.BelowLeft:case l.BelowRight:d.y=h>u.height||h>n?t.bottom:t.top-u.height;break;case l.LeftTop:case l.RightTop:d.y=t.top;break;case l.LeftBottom:case l.RightBottom:d.y=t.bottom-u.height;break;case l.Left:case l.Right:d.y=t.bottom-u.height+(u.height-t.height)/2}}d.x=Math.min(d.x,r-u.width);d.y=Math.min(d.y,o-u.height);d.x=Math.max(0,d.x)+i.x;d.y=Math.max(0,d.y)+i.y;return d}function _getRtlPosition(e){let t=PopupPosition;switch(e){case t.AboveLeft:return t.AboveRight;case t.AboveRight:return t.AboveLeft;case t.BelowLeft:return t.BelowRight;case t.BelowRight:return t.BelowLeft;case t.Left:return t.Right;case t.LeftTop:return t.RightTop;case t.LeftBottom:return t.RightBottom;case t.Right:return t.Left;case t.RightTop:return t.LeftTop;case t.RightBottom:return t.LeftBottom}return e}function _getReferenceRect(e,t){return t instanceof MouseEvent?t.clientX<=0&&t.clientY<=0&&t.target instanceof HTMLElement?Rect.fromBoundingRect(t.target.getBoundingClientRect()):new Rect(t.pageX-pageXOffset,t.pageY-pageYOffset,0,0):t instanceof Point?new Rect(t.x,t.y,0,0):t instanceof HTMLElement?Rect.fromBoundingRect(t.getBoundingClientRect()):t&&null!=t.top&&null!=t.left?t:null}class Tooltip{constructor(e){this._showAutoTipBnd=this._showAutoTip.bind(this);this._hideAutoTipBnd=this._hideAutoTip.bind(this);this._mousemoveBnd=this._mousemove.bind(this);this._html=!0;this._cssClass="";this._gap=6;this._isAnimated=!1;this._position=PopupPosition.Above;this._showAtMouse=!1;this._showDelay=500;this._hideDelay=0;this._tips=[];this.popup=new Event;copy(this,e)}get position(){return this._position}set position(e){this._position=asEnum(e,PopupPosition)}get isAnimated(){return this._isAnimated}set isAnimated(e){this._isAnimated=asBoolean(e)}setTooltip(e,t,s){e=getElement(e);t=this._getContent(t);let i=this._indexOf(e);if(i>-1){this._detach(e);this._tips.splice(i,1)}if(t){this._attach(e);this._tips.push({element:e,content:t,position:s})}let n=Tooltip._eTip;n&&n[Control._TTIP_KEY]==e&&(t?this._setContent(t):this._hideAutoTip())}getTooltip(e){e=getElement(e);let t=this._tips;for(let s=0;s<t.length;s++)if(t[s].element==e)return t[s].content;return null}show(e,t,s,i){e=getElement(e);t=this._getContent(t);if(!e)return;null==i&&(i=this.position);let n=Tooltip._eTip;if(!n){addClass(n=Tooltip._eTip=document.createElement("div"),"wj-tooltip");n.style.visibility="none"}addClass(n,this.cssClass);this._setContent(t);n[Control._TTIP_KEY]=e;let r=new TooltipEventArgs(t,e);this.onPopup(r);if(r.content&&!r.cancel){this._setContent(r.content);s||(s=Rect.fromBoundingRect(e.getBoundingClientRect()));let t=this.gap,o=PopupPosition;if(t)switch(i){case o.Above:case o.AboveLeft:case o.AboveRight:case o.Below:case o.BelowLeft:case o.BelowRight:s=s.inflate(0,t);break;default:s=s.inflate(t,0)}showPopup(n,s,i,this.isAnimated);document.addEventListener("mousedown",this._hideAutoTipBnd)}}hide(){let e=Tooltip._eTip;if(e){removeChild(e);removeClass(e,this.cssClass);e.innerHTML=""}document.removeEventListener("mousedown",this._hideAutoTipBnd)}dispose(){this.isVisible&&this.hide();let e=this._tips;if(e.length){e.forEach(e=>{this._detach(e.element)});e.splice(0,e.length)}this._clearTimeouts()}get isVisible(){let e=Tooltip._eTip;return null!=e&&null!=e.parentElement&&e.offsetWidth>0}get isContentHtml(){return this._html}set isContentHtml(e){this._html=asBoolean(e)}get cssClass(){return this._cssClass}set cssClass(e){this._cssClass=asString(e)}get gap(){return this._gap}set gap(e){this._gap=asNumber(e)}get showAtMouse(){return this._showAtMouse}set showAtMouse(e){this._showAtMouse=asBoolean(e)}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=asInt(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=asInt(e)}onPopup(e){this.popup&&this.popup.raise(this,e);return!e.cancel}_indexOf(e){for(let t=0;t<this._tips.length;t++)if(this._tips[t].element==e)return t;return-1}_attach(e){e.addEventListener("mouseenter",this._showAutoTipBnd);e.addEventListener("mouseleave",this._hideAutoTipBnd);e.addEventListener("click",this._showAutoTipBnd);this.showAtMouse&&e.addEventListener("mousemove",this._mousemoveBnd)}_detach(e){e.removeEventListener("mouseenter",this._showAutoTipBnd);e.removeEventListener("mouseleave",this._hideAutoTipBnd);e.removeEventListener("click",this._showAutoTipBnd);e.removeEventListener("mousemove",this._mousemoveBnd)}_showAutoTip(e){if(e.defaultPrevented)return;if("click"==e.type&&!Control._touching){this._hideAutoTip();return}let t="mouseenter"==e.type?this._showDelay:0,s=this._hideDelay;this._clearTimeouts();this._eMouse=e;this._toShow=setTimeout(()=>{let t=this._indexOf(e.target);if(t>-1){let e=this._tips[t],i=this._eMouse,n=this._showAtMouse?new Rect(i.clientX,i.clientY,0,0):null;const r=e&&e.element;if(r&&(r.offsetHeight||r.offsetWidth)){let t=Control.getControl(e.element);if(null==t||0!=t.isVisible){this.show(e.element,e.content,n,e.position);s>0&&(this._toHide=setTimeout(()=>{this.hide()},s))}}}},t)}_mousemove(e){this._eMouse=e}_hideAutoTip(){this._clearTimeouts();this.hide()}_clearTimeouts(){if(this._toShow){clearTimeout(this._toShow);this._toShow=null}if(this._toHide){clearTimeout(this._toHide);this._toHide=null}}_getContent(e){if((e=asString(e))&&"#"==e[0]){let t=getElement(e);t&&(e=t.innerHTML)}return e}_setContent(e){let t=Tooltip._eTip;t&&(this._html?t.innerHTML=e:t.textContent=e)}}exports.Tooltip=Tooltip;class TooltipEventArgs extends CancelEventArgs{constructor(e,t){super();this._content=asString(e);this._e=t}get tip(){return Tooltip._eTip}get element(){return this._e}get content(){return this._content}set content(e){this._content=asString(e)}}exports.TooltipEventArgs=TooltipEventArgs;_registerModule("wijmo",selfModule);var theLic="The Wijmo license in this application ",_licStr={evl:"Wijmo Evaluation Version ({version})",prd:theLic+"is not valid for the <b>{control}</b> control.",ver:theLic+"is not valid for the version in use. The license version is <b>{licVer}</b>; the product version is <b>{version}</b>.",dmn:theLic+"is not valid for the current domain. The license domain is <b>{licDomain}</b>; the current domain is <b>{domain}</b>.",exp:theLic+"has expired. The license expiration date is <b>{expDate:d}</b>.",lic:theLic+"is invalid.",mss:theLic+"is not set.",ctc:'If you are a customer, you can <a target="_blank" rel="noopener" href="https://www.grapecity.com/licensing/wijmo?utm_source=Wijmo-In-App&utm_medium=Click-to-Site&utm_campaign=Wijmo-User-Analysis">create a license</a> online. Otherwise, you can <a target="_blank" rel="noopener" href="https://www.grapecity.com/wijmo/request-trial-key?utm_source=Wijmo-In-App&utm_medium=Click-to-Site&utm_campaign=Wijmo-User-Analysis">generate a 30-day license</a> for free. For further assistance, contact GrapeCity: <a href="mailto:us.sales@grapecity.com">us.sales@grapecity.com</a>.',hdr:"Wijmo License",cls:"CLOSE"},_codes={};function _updateWme(e,t){let s=Control._wme;if(!(s&&contains(document.body,s)&&s.offsetWidth&&s.offsetHeight))if(t){let s=_getControlCode(e);if(!_codes[s]){_codes[s]=!0;_attorn(t,{algorithmCode:"B0",publicKey:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w=="},i=>{_checkLicense(e,t,i);delete _codes[s]},()=>{_checkLicense(e,t,null);delete _codes[s]})}}else _checkLicense(e,null,null)}exports._updateWme=_updateWme;function _getControlCode(e){return e._getProductInfo().split(",")[0]}function _getControlName(e){return e._getProductInfo().split(",")[1]}function _checkLicense(e,t,s){let i=exports.culture.Licensing||_licStr,n=null;s?_checkExpiration(e,s)?_checkVersion(e,s)?_checkDomain(e,s)?_checkProductCode(e,s)?_checkEval(e,s)&&(n=i.evl):n=i.prd:n=i.dmn:n=i.ver:n=i.exp:n=t?i.lic:i.mss;n&&_addWme(e,n+="<br/><br/>"+i.ctc,s)}function _checkProductCode(e,t){let s=_getControlCode(e);if(s&&s.length>=4)for(let e=0;e<t.Prd.length;e++)if(t.Prd[e].C.indexOf(s)>-1)return!0;return!1}function _checkExpiration(e,t){if(t.Exp){let e=t.Exp,s=new Date(parseInt(e.substr(0,4))||0,parseInt(e.substr(4,2))-1||0,parseInt(e.substr(6,2))||0);if(Math.ceil((s.valueOf()-Date.now())/864e5)<=0)return!1}return!0}function _checkVersion(e,t){let s=t.Anl?t.Anl.ver:null,i=getVersion();if(s&&i){return parseInt(s.replace("v",""))+10>=parseInt(i.split(".")[1])}return!0}function _checkDomain(e,t){if(_isLocalHost()||!t.Dms)return!0;let s=location.hostname,i=t.Dms.split(",");for(let e=0;e<i.length;e++)if(_checkHost(s,i[e]))return!0;return!1}function _checkHost(e,t){var s="^"+t.replace(/\./g,"\\.").replace(/\*/g,"(.*)")+"$",i=new RegExp(s,"i").test(e);return i||"*."!=t.substr(0,2)?i:_checkHost(e,t.substr(2))}function _checkEval(e,t){return!!t&&t.Evl}function _isLocalHost(){let e=location,t=atob("Xih8bG9jYWxob3N0fGZpZGRsZS5qc2hlbGwubmV0fHJ1bi5wbG5rci5jb3xzLmNvZGVwZW4uaW98bnVsbC5qc2Jpbi5jb218Lio/LnN0YWNrYmxpdHouaW98MTI3LjAuMC4xfFt3LV0rLmxvY2FsfFt3LV0rfDo6MSkk");return"file:"==e.protocol||new RegExp(t,"i").test(e.hostname)}function _addWme(e,t,s){t=_getMessage(e,t,s);if(!_codes[" "]&&!_isLocalHost()&&!_checkEval(e,s)){_codes[" "]=!0;let e=exports.culture.Licensing||_licStr,s=createElement('<div style="position:fixed;background:rgba(0,0,0,0.3);left:0;top:0;width:100%;height:100%;font-family: sans-serif;z-index:10000;"><div style="position:relative;overflow:auto;background:white;width:450px;padding:36pt;left:50%;top:50%;transform:translate(-50%,-50%)"><div><p style="font-size:150%;font-weight:bold">'+e.hdr+"</p><p>"+t+'</p></div><div style="text-align:right;margin-top:24pt"><button style="border:none;background:rgba(158,158,158,.2);padding:8px 16px">'+e.cls+"</button></div></div></div>",document.body);s.addEventListener("click",e=>{e.target instanceof HTMLButtonElement&&removeChild(s)})}if(!Control._wme){let s=createElement('<div><a href="'+_getWmeHref()+'" target="_blank" rel="noopener">'+_getMessage(e)+"</a></div>"),i={position:"fixed",display:"block",visibility:"visible",background:"rgba(240,240,240,.9)",padding:"8px 12px",margin:"6px",fontFamily:"sans-serif",fontSize:"14pt",fontWeight:"bold",zIndex:1e4,opacity:.8,height:"auto",width:"auto",transform:"none"};switch(Math.round(100*Math.random())%3){case 0:i.right=i.bottom=0;break;case 1:i.left=i.bottom=0;break;case 2:i.right=i.top=0}setCss(s,i);document.body.appendChild(s);Control._wme=s;_addClickableTooltip(s,t)}}function _addClickableTooltip(e,t){let s,i=createElement(t);i.className="wj-tooltip";setCss(i,{pointerEvents:"auto",padding:"10px",margin:"6px"});[e,i].forEach(e=>{e.addEventListener("mouseenter",()=>trackMouse(!0));e.addEventListener("mouseleave",()=>trackMouse(!1))});let n=0;function trackMouse(t){n+=t?1:-1;s&&clearTimeout(s);s=setTimeout(()=>{s=null;1==n?showPopup(i,e.getBoundingClientRect()):n<1&&hidePopup(i)},500)}}function _getWmeHref(){switch(exports.culture.Globalize.name){case"ja":return"https://www.grapecity.co.jp/developer/support/wijmo-license";case"ko":return"https://www.grapecity.co.kr/wijmojs#price";default:return"https://www.grapecity.com/licensing/wijmo?utm_source=Wijmo-In-App&utm_medium=Click-to-Site&utm_campaign=Wijmo-User-Analysis"}}function _getMessage(e,t,s){if(!t||t.trim().length<15){t=(exports.culture.Licensing||_licStr).evl}(!t||t.trim().length<15)&&(t=atob("V2lqbW8gRXZhbHVhdGlvbiBWZXJzaW9uICh7dmVyc2lvbn0p"));let i=null;if(s&&s.Exp){let e=s.Exp;i=new Date(parseInt(e.substr(0,4))||0,parseInt(e.substr(4,2))-1||0,parseInt(e.substr(6,2))||0)}return t=format(t,{version:getVersion(),domain:location.hostname,control:_getControlName(e),licVer:s&&s.Anl?"5."+s.Anl.ver.replace("v","")+".*":null,licDomain:s?s.Dms:null,expDate:i})}function _attorn(e,t,s,i){let n=parseKeyData(e,t.algorithmCode);if(!n)return i();let r=n.lic,o=n.prefix+"#"+t.algorithmCode;if(tripleHash(o+JSON.stringify(r.D))!=r.H)return i();let l=window.msCrypto||window.crypto,a=l?l.subtle:null;if(!a||!location.protocol.match(/^https/i))return s(r.D);let h={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},c={alg:"RS256",e:"AQAB",kty:"RSA",n:str64ToJwkBase64(t.publicKey)};c=window.msCrypto?str2ArrayBuffer(JSON.stringify(c)):c;try{asPromise(a.importKey("jwk",c,h,!1,["verify"])).then(e=>{let t=arrayBuffer2Str(str64ToArrayBuffer(str64EncodeUnicode(o+JSON.stringify(r.D))));asPromise(a.verify(h,e,str64ToArrayBuffer(r.S),str2ArrayBuffer(t))).then(e=>e?s(r.D):i())},()=>s(r.D))}catch(e){return s(r.D)}}var uint8Array="undefined"==typeof window?null:window.Uint8Array||window.TypedArray;function parseKeyData(e,t){try{t="#"+t;let s=e.indexOf(t);if(s>-1)return{prefix:e.substring(0,s),lic:JSON.parse(decode(e.substr(s+t.length)))}}catch(e){}return null}function decode(e){if(!e)return"";let t=unshiftString(e);t=reverseString(t);let s=Math.ceil(t.length/2);return str64DecodeUnicode(t=(t=(t=t.substr(s)+t.substr(0,s)).replace("#","=")).replace("&","=="))}function unshiftString(e){let t=e.split("");for(let e=t.length-5;e>=0;e--){swapArrayElements(t,e+1,e+3,unshiftChar);swapArrayElements(t,e,e+2,unshiftChar)}return t.join("")}function swapArrayElements(e,t,s,i){e.length>1&&e.splice(s,1,i(e.splice(t,1,i(e[s]))[0]))}function shiftChar(e,t){let s=e.charCodeAt(0);return s>=65&&s<=90?e.toLowerCase():s>=97&&s<=122?e.toUpperCase():s>=48&&s<=57?String.fromCharCode(48+(s-48+10+t)%10):e}function unshiftChar(e){return shiftChar(e,-1)}function reverseString(e){return e.split("").reverse().join("")}function str64DecodeUnicode(e){let t=atob(e),s="";for(let e=0;e<t.length;e++)s+="%"+("00"+t.charCodeAt(e).toString(16)).slice(-2);return decodeURIComponent(s)}function arrayBuffer2Str(e){return String.fromCharCode.apply(null,new uint8Array(e))}function str64ToArrayBuffer(e){let t=atob(e),s=t.length,i=new uint8Array(s);for(let e=0;e<s;e++)i[e]=t.charCodeAt(e);return i.buffer}function str64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))}function str64ToJwkBase64(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function str2ArrayBuffer(e){let t=new ArrayBuffer(e.length),s=new uint8Array(t);for(let t=0,i=e.length;t<i;t++)s[t]=e.charCodeAt(t);return t}function tripleHash(e){let t=0,s=5381,i=0;for(let n=e.length-1;n>=0;n--){let r=e.charCodeAt(n);t=r+(t<<6)+(t<<16)-t;s=r+((s<<5)+s);i=r+((i<<5)-i)}let n=t^s^i;n<0&&(n=~n);return n.toString(16).toUpperCase()}function asPromise(e){if("oncomplete"in e){e.then=(t,s)=>{e.resolve=t;e.reject=s};e.oncomplete=t=>{e.resolve(e.result)};e.onerror=t=>{e.reject()}}return e}